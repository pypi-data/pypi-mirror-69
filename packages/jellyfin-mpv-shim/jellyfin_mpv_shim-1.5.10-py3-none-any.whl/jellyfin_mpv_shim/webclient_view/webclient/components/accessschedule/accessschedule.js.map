{"version":3,"sources":["components/accessschedule/accessschedule.js"],"names":["define","dialogHelper","datetime","getDisplayTime","hours","minutes","pct","parseInt","Date","show","options","Promise","resolve","reject","xhr","XMLHttpRequest","open","onload","e","template","this","response","dlg","createDialog","removeOnClose","size","classList","add","html","Globalize","translateDocument","innerHTML","populateHours","context","i","querySelector","loadSchedule","schedule","value","DayOfWeek","StartHour","EndHour","addEventListener","submitted","close","submitSchedule","updatedSchedule","parseFloat","alert","translate","Object","assign","preventDefault","send"],"mappings":"AAAA,aAAAA,OAAO,CAAC,eAAgB,WAAY,cAAe,0BAA2B,oBAAoB,SAAUC,aAAcC,UAGtH,SAASC,eAAeC,OACpB,IAAIC,QAAU,EACVC,IAAMF,MAAQ,EAMlB,OAJIE,MACAD,QAAUE,SAAS,GAAKD,MAGrBJ,SAASC,eAAe,IAAIK,KAAK,IAAM,EAAG,EAAGJ,MAAOC,QAAS,EAAG,IAqC3E,MAAO,CACHI,KAAM,SAAAA,KAAUC,SACZ,OAAO,IAAIC,SAAQ,SAAUC,QAASC,QAClC,IAAIC,IAAM,IAAIC,eACdD,IAAIE,KAAK,MAAO,0DAA0D,GAE1EF,IAAIG,OAAS,SAAUC,GACnB,IAAIC,SAAWC,KAAKC,SAChBC,IAAMrB,aAAasB,aAAa,CAChCC,eAAe,EACfC,KAAM,UAEVH,IAAII,UAAUC,IAAI,cAClB,IAAIC,KAAO,GACXA,MAAQC,UAAUC,kBAAkBX,UACpCG,IAAIS,UAAYH,KAjDhC,SAASI,cAAcC,SAGnB,IAFA,IAAIL,KAAO,GAEFM,EAAI,EAAGA,EAAI,GAAIA,IACpBN,MAAQ,kBAAoBM,EAAI,KAAO/B,eAAe+B,GAAK,YAG/DN,MAAQ,sBAAwBzB,eAAe,GAAK,YACpD8B,QAAQE,cAAc,gBAAgBJ,UAAYH,KAClDK,QAAQE,cAAc,cAAcJ,UAAYH,KAyCpCI,CAAcV,KAtC9B,SAASc,aAAaH,QAASI,UAC3BJ,QAAQE,cAAc,cAAcG,MAAQD,SAASE,WAAa,SAClEN,QAAQE,cAAc,gBAAgBG,MAAQD,SAASG,WAAa,EACpEP,QAAQE,cAAc,cAAcG,MAAQD,SAASI,SAAW,EAoCpDL,CAAad,IAAKZ,QAAQ2B,UAC1BpC,aAAae,KAAKM,KAClBA,IAAIoB,iBAAiB,SAAS,WACtBpB,IAAIqB,UACJ/B,QAAQF,QAAQ2B,UAEhBxB,YAGRS,IAAIa,cAAc,cAAcO,iBAAiB,SAAS,SAAUxB,GAChEjB,aAAa2C,MAAMtB,QAEvBA,IAAIa,cAAc,QAAQO,iBAAiB,UAAU,SAAUxB,GAG3D,OAhDpB,SAAS2B,eAAeZ,QAASvB,SAC7B,IAAIoC,gBAAkB,CAClBP,UAAWN,QAAQE,cAAc,cAAcG,MAC/CE,UAAWP,QAAQE,cAAc,gBAAgBG,MACjDG,QAASR,QAAQE,cAAc,cAAcG,OAG7CS,WAAWD,gBAAgBN,YAAcO,WAAWD,gBAAgBL,SACxDO,MAAMnB,UAAUoB,UAAU,yCAG1ChB,QAAQU,WAAY,EACpBjC,QAAQ2B,SAAWa,OAAOC,OAAOzC,QAAQ2B,SAAUS,iBACnD7C,aAAa2C,MAAMX,UAiCHY,CAAevB,IAAKZ,SACpBQ,EAAEkC,kBACK,MAIftC,IAAIuC","file":"accessschedule.js","sourcesContent":["define([\"dialogHelper\", \"datetime\", \"emby-select\", \"paper-icon-button-light\", \"formDialogStyle\"], function (dialogHelper, datetime) {\n    \"use strict\";\n\n    function getDisplayTime(hours) {\n        var minutes = 0;\n        var pct = hours % 1;\n\n        if (pct) {\n            minutes = parseInt(60 * pct);\n        }\n\n        return datetime.getDisplayTime(new Date(2000, 1, 1, hours, minutes, 0, 0));\n    }\n\n    function populateHours(context) {\n        var html = \"\";\n\n        for (var i = 0; i < 24; i++) {\n            html += '<option value=\"' + i + '\">' + getDisplayTime(i) + \"</option>\";\n        }\n\n        html += '<option value=\"24\">' + getDisplayTime(0) + \"</option>\";\n        context.querySelector(\"#selectStart\").innerHTML = html;\n        context.querySelector(\"#selectEnd\").innerHTML = html;\n    }\n\n    function loadSchedule(context, schedule) {\n        context.querySelector(\"#selectDay\").value = schedule.DayOfWeek || \"Sunday\";\n        context.querySelector(\"#selectStart\").value = schedule.StartHour || 0;\n        context.querySelector(\"#selectEnd\").value = schedule.EndHour || 0;\n    }\n\n    function submitSchedule(context, options) {\n        var updatedSchedule = {\n            DayOfWeek: context.querySelector(\"#selectDay\").value,\n            StartHour: context.querySelector(\"#selectStart\").value,\n            EndHour: context.querySelector(\"#selectEnd\").value\n        };\n\n        if (parseFloat(updatedSchedule.StartHour) >= parseFloat(updatedSchedule.EndHour)) {\n            return void alert(Globalize.translate(\"ErrorMessageStartHourGreaterThanEnd\"));\n        }\n\n        context.submitted = true;\n        options.schedule = Object.assign(options.schedule, updatedSchedule);\n        dialogHelper.close(context);\n    }\n\n    return {\n        show: function (options) {\n            return new Promise(function (resolve, reject) {\n                var xhr = new XMLHttpRequest();\n                xhr.open(\"GET\", \"components/accessschedule/accessschedule.template.html\", true);\n\n                xhr.onload = function (e) {\n                    var template = this.response;\n                    var dlg = dialogHelper.createDialog({\n                        removeOnClose: true,\n                        size: \"small\"\n                    });\n                    dlg.classList.add(\"formDialog\");\n                    var html = \"\";\n                    html += Globalize.translateDocument(template);\n                    dlg.innerHTML = html;\n                    populateHours(dlg);\n                    loadSchedule(dlg, options.schedule);\n                    dialogHelper.open(dlg);\n                    dlg.addEventListener(\"close\", function () {\n                        if (dlg.submitted) {\n                            resolve(options.schedule);\n                        } else {\n                            reject();\n                        }\n                    });\n                    dlg.querySelector(\".btnCancel\").addEventListener(\"click\", function (e) {\n                        dialogHelper.close(dlg);\n                    });\n                    dlg.querySelector(\"form\").addEventListener(\"submit\", function (e) {\n                        submitSchedule(dlg, options);\n                        e.preventDefault();\n                        return false;\n                    });\n                };\n\n                xhr.send();\n            });\n        }\n    };\n});\n"]}