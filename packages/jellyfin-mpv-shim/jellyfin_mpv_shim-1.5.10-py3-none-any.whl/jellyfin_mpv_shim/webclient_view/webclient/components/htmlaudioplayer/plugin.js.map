{"version":3,"sources":["components/htmlaudioplayer/plugin.js"],"names":["define","events","browser","require","appHost","appSettings","htmlMediaHelper","fadeTimeout","cancelFadeTimeout","clearTimeout","HtmlAudioPlayer","self","this","unBindEvents","elem","removeEventListener","onTimeUpdate","onEnded","onVolumeChange","onPause","onPlaying","onPlay","onEndedInternal","onError","time","currentTime","_isFadingOut","_currentTime","trigger","saveVolume","volume","e","_started","removeAttribute","seekOnPlaybackStart","target","_currentPlayOptions","playerStartPositionTicks","type","errorCode","error","code","errorMessage","message","console","toString","_hlsPlayer","handleHlsJsMediaError","onErrorInternal","name","id","priority","play","options","_timeUpdated","setCurrentSrc","bindEvents","addEventListener","val","url","debug","seconds","destroyHlsPlayer","crossOrigin","getCrossOriginValue","mediaSource","enableHlsPlayer","item","mediaType","enableHlsJsPlayer","RunTimeTicks","indexOf","Promise","resolve","reject","fetchHelper","ajax","then","response","headers","get","toLowerCase","requireHlsPlayer","callback","hls","window","Hls","manifestLoadingTimeOut","loadSource","attachMedia","bindEventsToHlsPlayer","_currentSrc","autoplay","applySrc","playWithPromise","createMediaElement","_mediaElement","document","querySelector","createElement","classList","add","body","appendChild","getSavedVolume","stop","destroyPlayer","src","supportsFade","tv","pause","destroy","originalVolume","fade","instance","startingVolume","newVolume","Math","max","setTimeout","prototype","currentSrc","canPlayMediaType","getDeviceProfile","getDefaultProfile","profileBuilder","mediaElement","duration","isValidDuration","seekable","length","start","end","getBufferedRanges","resume","unpause","paused","setVolume","getVolume","min","round","volumeUp","volumeDown","setMute","mute","muted","isMuted"],"mappings":"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","file":"plugin.js","sourcesContent":["define(['events', 'browser', 'require', 'apphost', 'appSettings', 'htmlMediaHelper'], function (events, browser, require, appHost, appSettings, htmlMediaHelper) {\n    \"use strict\";\n\n    function getDefaultProfile() {\n        return new Promise(function (resolve, reject) {\n            require(['browserdeviceprofile'], function (profileBuilder) {\n                resolve(profileBuilder({}));\n            });\n        });\n    }\n\n    var fadeTimeout;\n    function fade(instance, elem, startingVolume) {\n        instance._isFadingOut = true;\n\n        // Need to record the starting volume on each pass rather than querying elem.volume\n        // This is due to iOS safari not allowing volume changes and always returning the system volume value\n        var newVolume = Math.max(0, startingVolume - 0.15);\n        console.debug('fading volume to ' + newVolume);\n        elem.volume = newVolume;\n\n        if (newVolume <= 0) {\n            instance._isFadingOut = false;\n            return Promise.resolve();\n        }\n\n        return new Promise(function (resolve, reject) {\n            cancelFadeTimeout();\n            fadeTimeout = setTimeout(function () {\n                fade(instance, elem, newVolume).then(resolve, reject);\n            }, 100);\n        });\n    }\n\n    function cancelFadeTimeout() {\n        var timeout = fadeTimeout;\n        if (timeout) {\n            clearTimeout(timeout);\n            fadeTimeout = null;\n        }\n    }\n\n    function supportsFade() {\n        if (browser.tv) {\n            // Not working on tizen.\n            // We could possibly enable on other tv's, but all smart tv browsers tend to be pretty primitive\n            return false;\n        }\n\n        return true;\n    }\n\n    function requireHlsPlayer(callback) {\n        require(['hlsjs'], function (hls) {\n            window.Hls = hls;\n            callback();\n        });\n    }\n\n    function enableHlsPlayer(url, item, mediaSource, mediaType) {\n        if (!htmlMediaHelper.enableHlsJsPlayer(mediaSource.RunTimeTicks, mediaType)) {\n            return Promise.reject();\n        }\n\n        if (url.indexOf('.m3u8') !== -1) {\n            return Promise.resolve();\n        }\n\n        // issue head request to get content type\n        return new Promise(function (resolve, reject) {\n\n            require(['fetchHelper'], function (fetchHelper) {\n                fetchHelper.ajax({\n                    url: url,\n                    type: 'HEAD'\n                }).then(function (response) {\n                    var contentType = (response.headers.get('Content-Type') || '').toLowerCase();\n                    if (contentType === 'application/x-mpegurl') {\n                        resolve();\n                    } else {\n                        reject();\n                    }\n                }, reject);\n            });\n        });\n    }\n\n    function HtmlAudioPlayer() {\n        var self = this;\n\n        self.name = 'Html Audio Player';\n        self.type = 'mediaplayer';\n        self.id = 'htmlaudioplayer';\n\n        // Let any players created by plugins take priority\n        self.priority = 1;\n\n        self.play = function (options) {\n\n            self._started = false;\n            self._timeUpdated = false;\n            self._currentTime = null;\n\n            var elem = createMediaElement(options);\n            return setCurrentSrc(elem, options);\n        };\n\n        function setCurrentSrc(elem, options) {\n\n            elem.removeEventListener('error', onError);\n\n            unBindEvents(elem);\n            bindEvents(elem);\n\n            var val = options.url;\n            console.debug('playing url: ' + val);\n\n            // Convert to seconds\n            var seconds = (options.playerStartPositionTicks || 0) / 10000000;\n            if (seconds) {\n                val += '#t=' + seconds;\n            }\n\n            htmlMediaHelper.destroyHlsPlayer(self);\n\n            self._currentPlayOptions = options;\n\n            var crossOrigin = htmlMediaHelper.getCrossOriginValue(options.mediaSource);\n            if (crossOrigin) {\n                elem.crossOrigin = crossOrigin;\n            }\n\n            return enableHlsPlayer(val, options.item, options.mediaSource, 'Audio').then(function () {\n\n                return new Promise(function (resolve, reject) {\n\n                    requireHlsPlayer(function () {\n                        var hls = new Hls({\n                            manifestLoadingTimeOut: 20000\n                            //appendErrorMaxRetry: 6,\n                            //debug: true\n                        });\n                        hls.loadSource(val);\n                        hls.attachMedia(elem);\n\n                        htmlMediaHelper.bindEventsToHlsPlayer(self, hls, elem, onError, resolve, reject);\n\n                        self._hlsPlayer = hls;\n\n                        self._currentSrc = val;\n                    });\n                });\n\n            }, function () {\n\n                elem.autoplay = true;\n\n                return htmlMediaHelper.applySrc(elem, val, options).then(function () {\n\n                    self._currentSrc = val;\n\n                    return htmlMediaHelper.playWithPromise(elem, onError);\n                });\n            });\n        }\n\n        function bindEvents(elem) {\n            elem.addEventListener('timeupdate', onTimeUpdate);\n            elem.addEventListener('ended', onEnded);\n            elem.addEventListener('volumechange', onVolumeChange);\n            elem.addEventListener('pause', onPause);\n            elem.addEventListener('playing', onPlaying);\n            elem.addEventListener('play', onPlay);\n        }\n\n        function unBindEvents(elem) {\n            elem.removeEventListener('timeupdate', onTimeUpdate);\n            elem.removeEventListener('ended', onEnded);\n            elem.removeEventListener('volumechange', onVolumeChange);\n            elem.removeEventListener('pause', onPause);\n            elem.removeEventListener('playing', onPlaying);\n            elem.removeEventListener('play', onPlay);\n        }\n\n        self.stop = function (destroyPlayer) {\n\n            cancelFadeTimeout();\n\n            var elem = self._mediaElement;\n            var src = self._currentSrc;\n\n            if (elem && src) {\n\n                if (!destroyPlayer || !supportsFade()) {\n\n                    elem.pause();\n\n                    htmlMediaHelper.onEndedInternal(self, elem, onError);\n\n                    if (destroyPlayer) {\n                        self.destroy();\n                    }\n                    return Promise.resolve();\n                }\n\n                var originalVolume = elem.volume;\n\n                return fade(self, elem, elem.volume).then(function () {\n\n                    elem.pause();\n                    elem.volume = originalVolume;\n\n                    htmlMediaHelper.onEndedInternal(self, elem, onError);\n\n                    if (destroyPlayer) {\n                        self.destroy();\n                    }\n                });\n            }\n            return Promise.resolve();\n        };\n\n        self.destroy = function () {\n            unBindEvents(self._mediaElement);\n        };\n\n        function createMediaElement() {\n\n            var elem = self._mediaElement;\n\n            if (elem) {\n                return elem;\n            }\n\n            elem = document.querySelector('.mediaPlayerAudio');\n\n            if (!elem) {\n                elem = document.createElement('audio');\n                elem.classList.add('mediaPlayerAudio');\n                elem.classList.add('hide');\n\n                document.body.appendChild(elem);\n            }\n\n            elem.volume = htmlMediaHelper.getSavedVolume();\n\n            self._mediaElement = elem;\n\n            return elem;\n        }\n\n        function onEnded() {\n\n            htmlMediaHelper.onEndedInternal(self, this, onError);\n        }\n\n        function onTimeUpdate() {\n\n            // Get the player position + the transcoding offset\n            var time = this.currentTime;\n\n            // Don't trigger events after user stop\n            if (!self._isFadingOut) {\n                self._currentTime = time;\n                events.trigger(self, 'timeupdate');\n            }\n        }\n\n        function onVolumeChange() {\n\n            if (!self._isFadingOut) {\n                htmlMediaHelper.saveVolume(this.volume);\n                events.trigger(self, 'volumechange');\n            }\n        }\n\n        function onPlaying(e) {\n\n            if (!self._started) {\n                self._started = true;\n                this.removeAttribute('controls');\n\n                htmlMediaHelper.seekOnPlaybackStart(self, e.target, self._currentPlayOptions.playerStartPositionTicks);\n            }\n            events.trigger(self, 'playing');\n        }\n\n        function onPlay(e) {\n\n            events.trigger(self, 'unpause');\n        }\n\n        function onPause() {\n            events.trigger(self, 'pause');\n        }\n\n        function onError() {\n\n            var errorCode = this.error ? (this.error.code || 0) : 0;\n            var errorMessage = this.error ? (this.error.message || '') : '';\n            console.error('media element error: ' + errorCode.toString() + ' ' + errorMessage);\n\n            var type;\n\n            switch (errorCode) {\n                case 1:\n                    // MEDIA_ERR_ABORTED\n                    // This will trigger when changing media while something is playing\n                    return;\n                case 2:\n                    // MEDIA_ERR_NETWORK\n                    type = 'network';\n                    break;\n                case 3:\n                    // MEDIA_ERR_DECODE\n                    if (self._hlsPlayer) {\n                        htmlMediaHelper.handleHlsJsMediaError(self);\n                        return;\n                    } else {\n                        type = 'mediadecodeerror';\n                    }\n                    break;\n                case 4:\n                    // MEDIA_ERR_SRC_NOT_SUPPORTED\n                    type = 'medianotsupported';\n                    break;\n                default:\n                    // seeing cases where Edge is firing error events with no error code\n                    // example is start playing something, then immediately change src to something else\n                    return;\n            }\n\n            htmlMediaHelper.onErrorInternal(self, type);\n        }\n    }\n\n    HtmlAudioPlayer.prototype.currentSrc = function () {\n        return this._currentSrc;\n    };\n\n    HtmlAudioPlayer.prototype.canPlayMediaType = function (mediaType) {\n\n        return (mediaType || '').toLowerCase() === 'audio';\n    };\n\n    HtmlAudioPlayer.prototype.getDeviceProfile = function (item) {\n\n        if (appHost.getDeviceProfile) {\n            return appHost.getDeviceProfile(item);\n        }\n\n        return getDefaultProfile();\n    };\n\n    // Save this for when playback stops, because querying the time at that point might return 0\n    HtmlAudioPlayer.prototype.currentTime = function (val) {\n\n        var mediaElement = this._mediaElement;\n        if (mediaElement) {\n            if (val != null) {\n                mediaElement.currentTime = val / 1000;\n                return;\n            }\n\n            var currentTime = this._currentTime;\n            if (currentTime) {\n                return currentTime * 1000;\n            }\n\n            return (mediaElement.currentTime || 0) * 1000;\n        }\n    };\n\n    HtmlAudioPlayer.prototype.duration = function (val) {\n\n        var mediaElement = this._mediaElement;\n        if (mediaElement) {\n            var duration = mediaElement.duration;\n            if (htmlMediaHelper.isValidDuration(duration)) {\n                return duration * 1000;\n            }\n        }\n\n        return null;\n    };\n\n    HtmlAudioPlayer.prototype.seekable = function () {\n        var mediaElement = this._mediaElement;\n        if (mediaElement) {\n\n            var seekable = mediaElement.seekable;\n            if (seekable && seekable.length) {\n\n                var start = seekable.start(0);\n                var end = seekable.end(0);\n\n                if (!htmlMediaHelper.isValidDuration(start)) {\n                    start = 0;\n                }\n                if (!htmlMediaHelper.isValidDuration(end)) {\n                    end = 0;\n                }\n\n                return (end - start) > 0;\n            }\n\n            return false;\n        }\n    };\n\n    HtmlAudioPlayer.prototype.getBufferedRanges = function () {\n        var mediaElement = this._mediaElement;\n        if (mediaElement) {\n\n            return htmlMediaHelper.getBufferedRanges(this, mediaElement);\n        }\n\n        return [];\n    };\n\n    HtmlAudioPlayer.prototype.pause = function () {\n        var mediaElement = this._mediaElement;\n        if (mediaElement) {\n            mediaElement.pause();\n        }\n    };\n\n    // This is a retry after error\n    HtmlAudioPlayer.prototype.resume = function () {\n        var mediaElement = this._mediaElement;\n        if (mediaElement) {\n            mediaElement.play();\n        }\n    };\n\n    HtmlAudioPlayer.prototype.unpause = function () {\n        var mediaElement = this._mediaElement;\n        if (mediaElement) {\n            mediaElement.play();\n        }\n    };\n\n    HtmlAudioPlayer.prototype.paused = function () {\n\n        var mediaElement = this._mediaElement;\n        if (mediaElement) {\n            return mediaElement.paused;\n        }\n\n        return false;\n    };\n\n    HtmlAudioPlayer.prototype.setVolume = function (val) {\n        var mediaElement = this._mediaElement;\n        if (mediaElement) {\n            mediaElement.volume = val / 100;\n        }\n    };\n\n    HtmlAudioPlayer.prototype.getVolume = function () {\n        var mediaElement = this._mediaElement;\n        if (mediaElement) {\n\n            return Math.min(Math.round(mediaElement.volume * 100), 100);\n        }\n    };\n\n    HtmlAudioPlayer.prototype.volumeUp = function () {\n        this.setVolume(Math.min(this.getVolume() + 2, 100));\n    };\n\n    HtmlAudioPlayer.prototype.volumeDown = function () {\n        this.setVolume(Math.max(this.getVolume() - 2, 0));\n    };\n\n    HtmlAudioPlayer.prototype.setMute = function (mute) {\n\n        var mediaElement = this._mediaElement;\n        if (mediaElement) {\n            mediaElement.muted = mute;\n        }\n    };\n\n    HtmlAudioPlayer.prototype.isMuted = function () {\n        var mediaElement = this._mediaElement;\n        if (mediaElement) {\n            return mediaElement.muted;\n        }\n        return false;\n    };\n\n    HtmlAudioPlayer.prototype.destroy = function () {\n\n    };\n\n    return HtmlAudioPlayer;\n});\n"]}