{"version":3,"sources":["components/filterdialog/filterdialog.js"],"names":["define","dialogHelper","globalize","connectionManager","events","browser","require","renderOptions","context","selector","cssClass","items","isCheckedFn","elem","querySelector","length","classList","remove","add","html","map","filter","itemHtml","join","innerHTML","loadDynamicFilters","apiClient","userId","itemQuery","getJSON","getUrl","UserId","ParentId","IncludeItemTypes","then","result","renderFilters","query","Tags","Math","min","Genres","i","indexOf","OfficialRatings","Years","triggerChange","instance","trigger","parentWithClass","className","contains","parentNode","enableDynamicFilters","mode","options","onFavoriteChange","StartIndex","IsFavorite","this","checked","self","onStandardFilterChange","filterName","getAttribute","filters","Filters","replace","substring","onVideoTypeFilterChange","VideoTypes","onStatusChange","SeriesStatus","show","Promise","resolve","reject","template","dlg","createDialog","removeOnClose","modal","translateDocument","setVisibility","hideByClass","elems","querySelectorAll","showByClass","open","addEventListener","updateFilterControls","IsLiked","IsDisliked","chkStandardFilter","chkVideoTypeFilter","Is3D","IsHD","Is4K","HasSubtitles","HasTrailer","HasThemeSong","HasThemeVideo","HasSpecialFeature","ParentIndexNumber","IsMissing","IsUnaired","chkStatus","bindEvents","IsVirtualUnaired","e","chkGenreFilter","target","delimiter","chkTagFilter","chkYearFilter","chkOfficialRatingFilter","getApiClient","serverId","getCurrentUserId"],"mappings":"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","file":"filterdialog.js","sourcesContent":["define([\"dialogHelper\", \"globalize\", \"connectionManager\", \"events\", \"browser\", \"require\", \"emby-checkbox\", \"emby-collapse\", \"css!./style\"], function (dialogHelper, globalize, connectionManager, events, browser, require) {\n    \"use strict\";\n\n    function renderOptions(context, selector, cssClass, items, isCheckedFn) {\n        var elem = context.querySelector(selector);\n        if (items.length) {\n            elem.classList.remove(\"hide\");\n        } else {\n            elem.classList.add(\"hide\");\n        }\n        var html = \"\";\n        html += '<div class=\"checkboxList\">';\n        html += items.map(function (filter) {\n            var itemHtml = \"\";\n            var checkedHtml = isCheckedFn(filter) ? \" checked\" : \"\";\n            itemHtml += \"<label>\";\n            itemHtml += '<input is=\"emby-checkbox\" type=\"checkbox\"' + checkedHtml + ' data-filter=\"' + filter + '\" class=\"' + cssClass + '\"/>';\n            itemHtml += \"<span>\" + filter + \"</span>\";\n            itemHtml += \"</label>\";\n            return itemHtml;\n        }).join(\"\");\n        html += \"</div>\";\n        elem.querySelector(\".filterOptions\").innerHTML = html;\n    }\n\n    function renderFilters(context, result, query) {\n        if (result.Tags) {\n            result.Tags.length = Math.min(result.Tags.length, 50);\n        }\n        renderOptions(context, \".genreFilters\", \"chkGenreFilter\", result.Genres, function (i) {\n            var delimeter = \"|\";\n            return (delimeter + (query.Genres || \"\") + delimeter).indexOf(delimeter + i + delimeter) != -1;\n        });\n        renderOptions(context, \".officialRatingFilters\", \"chkOfficialRatingFilter\", result.OfficialRatings, function (i) {\n            var delimeter = \"|\";\n            return (delimeter + (query.OfficialRatings || \"\") + delimeter).indexOf(delimeter + i + delimeter) != -1;\n        });\n        renderOptions(context, \".tagFilters\", \"chkTagFilter\", result.Tags, function (i) {\n            var delimeter = \"|\";\n            return (delimeter + (query.Tags || \"\") + delimeter).indexOf(delimeter + i + delimeter) != -1;\n        });\n        renderOptions(context, \".yearFilters\", \"chkYearFilter\", result.Years, function (i) {\n            var delimeter = \",\";\n            return (delimeter + (query.Years || \"\") + delimeter).indexOf(delimeter + i + delimeter) != -1;\n        });\n    }\n\n    function loadDynamicFilters(context, apiClient, userId, itemQuery) {\n        return apiClient.getJSON(apiClient.getUrl(\"Items/Filters\", {\n            UserId: userId,\n            ParentId: itemQuery.ParentId,\n            IncludeItemTypes: itemQuery.IncludeItemTypes\n        })).then(function (result) {\n            renderFilters(context, result, itemQuery);\n        });\n    }\n\n    function updateFilterControls(context, options) {\n        var elems;\n        var i;\n        var length;\n        var query = options.query;\n\n        if (options.mode == \"livetvchannels\") {\n            context.querySelector(\".chkFavorite\").checked = query.IsFavorite == true;\n            context.querySelector(\".chkLikes\").checked = query.IsLiked == true;\n            context.querySelector(\".chkDislikes\").checked = query.IsDisliked == true;\n        } else {\n            elems = context.querySelectorAll(\".chkStandardFilter\");\n            for (i = 0, length = elems.length; i < length; i++) {\n                var chkStandardFilter = elems[i];\n                var filters = \",\" + (query.Filters || \"\");\n                var filterName = chkStandardFilter.getAttribute(\"data-filter\");\n                chkStandardFilter.checked = filters.indexOf(\",\" + filterName) != -1;\n            }\n        }\n\n        elems = context.querySelectorAll(\".chkVideoTypeFilter\");\n        for (i = 0, length = elems.length; i < length; i++) {\n            var chkVideoTypeFilter = elems[i];\n            var filters = \",\" + (query.VideoTypes || \"\");\n            var filterName = chkVideoTypeFilter.getAttribute(\"data-filter\");\n            chkVideoTypeFilter.checked = filters.indexOf(\",\" + filterName) != -1;\n        }\n        context.querySelector(\".chk3DFilter\").checked = query.Is3D == true;\n        context.querySelector(\".chkHDFilter\").checked = query.IsHD == true;\n        context.querySelector(\".chk4KFilter\").checked = query.Is4K == true;\n        context.querySelector(\".chkSDFilter\").checked = query.IsHD == true;\n        context.querySelector(\"#chkSubtitle\").checked = query.HasSubtitles == true;\n        context.querySelector(\"#chkTrailer\").checked = query.HasTrailer == true;\n        context.querySelector(\"#chkThemeSong\").checked = query.HasThemeSong == true;\n        context.querySelector(\"#chkThemeVideo\").checked = query.HasThemeVideo == true;\n        context.querySelector(\"#chkSpecialFeature\").checked = query.HasSpecialFeature == true;\n        context.querySelector(\"#chkSpecialEpisode\").checked = query.ParentIndexNumber == 0;\n        context.querySelector(\"#chkMissingEpisode\").checked = query.IsMissing == true;\n        context.querySelector(\"#chkFutureEpisode\").checked = query.IsUnaired == true;\n        for (i = 0, length = elems.length; i < length; i++) {\n            var chkStatus = elems[i];\n            var filters = \",\" + (query.SeriesStatus || \"\");\n            var filterName = chkStatus.getAttribute(\"data-filter\");\n            chkStatus.checked = filters.indexOf(\",\" + filterName) != -1;\n        }\n    }\n\n    function triggerChange(instance) {\n        events.trigger(instance, \"filterchange\");\n    }\n\n    function parentWithClass(elem, className) {\n        while (!elem.classList || !elem.classList.contains(className)) {\n            elem = elem.parentNode;\n            if (!elem) {\n                return null;\n            }\n        }\n        return elem;\n    }\n\n    function setVisibility(context, options) {\n        if (options.mode == \"livetvchannels\" || options.mode == \"albums\" || options.mode == \"artists\" || options.mode == \"albumartists\" || options.mode == \"songs\") {\n            hideByClass(context, \"videoStandard\");\n        }\n\n        if (enableDynamicFilters(options.mode)) {\n            context.querySelector(\".genreFilters\").classList.remove(\"hide\");\n            context.querySelector(\".officialRatingFilters\").classList.remove(\"hide\");\n            context.querySelector(\".tagFilters\").classList.remove(\"hide\");\n            context.querySelector(\".yearFilters\").classList.remove(\"hide\");\n        }\n\n        if (options.mode == \"movies\" || options.mode == \"episodes\") {\n            context.querySelector(\".videoTypeFilters\").classList.remove(\"hide\");\n        }\n\n        if (options.mode == \"movies\" || options.mode == \"series\" || options.mode == \"episodes\") {\n            context.querySelector(\".features\").classList.remove(\"hide\");\n        }\n\n        if (options.mode == \"series\") {\n            context.querySelector(\".seriesStatus\").classList.remove(\"hide\");\n        }\n\n        if (options.mode == \"episodes\") {\n            showByClass(context, \"episodeFilter\");\n        }\n    }\n\n    function showByClass(context, className) {\n        var elems = context.querySelectorAll(\".\" + className);\n\n        for (var i = 0, length = elems.length; i < length; i++) {\n            elems[i].classList.remove(\"hide\");\n        }\n    }\n\n    function hideByClass(context, className) {\n        var elems = context.querySelectorAll(\".\" + className);\n\n        for (var i = 0, length = elems.length; i < length; i++) {\n            elems[i].classList.add(\"hide\");\n        }\n    }\n\n    function enableDynamicFilters(mode) {\n        return mode == \"movies\" || mode == \"series\" || mode == \"albums\" || mode == \"albumartists\" || mode == \"artists\" || mode == \"songs\" || mode == \"episodes\";\n    }\n\n    return function (options) {\n        function onFavoriteChange() {\n            var query = options.query;\n            query.StartIndex = 0;\n            query.IsFavorite = !!this.checked || null;\n            triggerChange(self);\n        }\n\n        function onStandardFilterChange() {\n            var query = options.query;\n            var filterName = this.getAttribute(\"data-filter\");\n            var filters = query.Filters || \"\";\n            filters = (\",\" + filters).replace(\",\" + filterName, \"\").substring(1);\n\n            if (this.checked) {\n                filters = filters ? filters + \",\" + filterName : filterName;\n            }\n\n            query.StartIndex = 0;\n            query.Filters = filters;\n            triggerChange(self);\n        }\n\n        function onVideoTypeFilterChange() {\n            var query = options.query;\n            var filterName = this.getAttribute(\"data-filter\");\n            var filters = query.VideoTypes || \"\";\n            filters = (\",\" + filters).replace(\",\" + filterName, \"\").substring(1);\n\n            if (this.checked) {\n                filters = filters ? filters + \",\" + filterName : filterName;\n            }\n\n            query.StartIndex = 0;\n            query.VideoTypes = filters;\n            triggerChange(self);\n        }\n\n        function onStatusChange() {\n            var query = options.query;\n            var filterName = this.getAttribute(\"data-filter\");\n            var filters = query.SeriesStatus || \"\";\n            filters = (\",\" + filters).replace(\",\" + filterName, \"\").substring(1);\n\n            if (this.checked) {\n                filters = filters ? filters + \",\" + filterName : filterName;\n            }\n\n            query.SeriesStatus = filters;\n            query.StartIndex = 0;\n            triggerChange(self);\n        }\n\n        function bindEvents(context) {\n            var elems;\n            var i;\n            var length;\n            var query = options.query;\n\n            if (options.mode == \"livetvchannels\") {\n                elems = context.querySelectorAll(\".chkFavorite\");\n                for (i = 0, length = elems.length; i < length; i++) {\n                    elems[i].addEventListener(\"change\", onFavoriteChange);\n                }\n                context.querySelector(\".chkLikes\").addEventListener(\"change\", function () {\n                    query.StartIndex = 0;\n                    query.IsLiked = this.checked ? true : null;\n                    triggerChange(self);\n                });\n                context.querySelector(\".chkDislikes\").addEventListener(\"change\", function () {\n                    query.StartIndex = 0;\n                    query.IsDisliked = this.checked ? true : null;\n                    triggerChange(self);\n                });\n            } else {\n                elems = context.querySelectorAll(\".chkStandardFilter\");\n                for (i = 0, length = elems.length; i < length; i++) {\n                    elems[i].addEventListener(\"change\", onStandardFilterChange);\n                }\n            }\n            elems = context.querySelectorAll(\".chkVideoTypeFilter\");\n            for (i = 0, length = elems.length; i < length; i++) {\n                elems[i].addEventListener(\"change\", onVideoTypeFilterChange);\n            }\n            context.querySelector(\".chk3DFilter\").addEventListener(\"change\", function () {\n                query.StartIndex = 0;\n                query.Is3D = this.checked ? true : null;\n                triggerChange(self);\n            });\n            context.querySelector(\".chk4KFilter\").addEventListener(\"change\", function () {\n                query.StartIndex = 0;\n                query.Is4K = this.checked ? true : null;\n                triggerChange(self);\n            });\n            context.querySelector(\".chkHDFilter\").addEventListener(\"change\", function () {\n                query.StartIndex = 0;\n                query.IsHD = this.checked ? true : null;\n                triggerChange(self);\n            });\n            context.querySelector(\".chkSDFilter\").addEventListener(\"change\", function () {\n                query.StartIndex = 0;\n                query.IsHD = this.checked ? false : null;\n                triggerChange(self);\n            });\n            elems = context.querySelectorAll(\".chkStatus\");\n            for (i = 0, length = elems.length; i < length; i++) {\n                elems[i].addEventListener(\"change\", onStatusChange);\n            }\n            context.querySelector(\"#chkTrailer\").addEventListener(\"change\", function () {\n                query.StartIndex = 0;\n                query.HasTrailer = this.checked ? true : null;\n                triggerChange(self);\n            });\n            context.querySelector(\"#chkThemeSong\").addEventListener(\"change\", function () {\n                query.StartIndex = 0;\n                query.HasThemeSong = this.checked ? true : null;\n                triggerChange(self);\n            });\n            context.querySelector(\"#chkSpecialFeature\").addEventListener(\"change\", function () {\n                query.StartIndex = 0;\n                query.HasSpecialFeature = this.checked ? true : null;\n                triggerChange(self);\n            });\n            context.querySelector(\"#chkThemeVideo\").addEventListener(\"change\", function () {\n                query.StartIndex = 0;\n                query.HasThemeVideo = this.checked ? true : null;\n                triggerChange(self);\n            });\n            context.querySelector(\"#chkMissingEpisode\").addEventListener(\"change\", function () {\n                query.StartIndex = 0;\n                query.IsMissing = this.checked ? true : false;\n                triggerChange(self);\n            });\n            context.querySelector(\"#chkSpecialEpisode\").addEventListener(\"change\", function () {\n                query.StartIndex = 0;\n                query.ParentIndexNumber = this.checked ? 0 : null;\n                triggerChange(self);\n            });\n            context.querySelector(\"#chkFutureEpisode\").addEventListener(\"change\", function () {\n                query.StartIndex = 0;\n                if (this.checked) {\n                    query.IsUnaired = true;\n                    query.IsVirtualUnaired = null;\n                } else {\n                    query.IsUnaired = null;\n                    query.IsVirtualUnaired = false;\n                }\n                triggerChange(self);\n            });\n            context.querySelector(\"#chkSubtitle\").addEventListener(\"change\", function () {\n                query.StartIndex = 0;\n                query.HasSubtitles = this.checked ? true : null;\n                triggerChange(self);\n            });\n            context.addEventListener(\"change\", function (e) {\n                var chkGenreFilter = parentWithClass(e.target, \"chkGenreFilter\");\n                if (chkGenreFilter) {\n                    var filterName = chkGenreFilter.getAttribute(\"data-filter\");\n                    var filters = query.Genres || \"\";\n                    var delimiter = \"|\";\n                    filters = (delimiter + filters).replace(delimiter + filterName, \"\").substring(1);\n                    if (chkGenreFilter.checked) {\n                        filters = filters ? (filters + delimiter + filterName) : filterName;\n                    }\n                    query.StartIndex = 0;\n                    query.Genres = filters;\n                    triggerChange(self);\n                    return;\n                }\n                var chkTagFilter = parentWithClass(e.target, \"chkTagFilter\");\n                if (chkTagFilter) {\n                    var filterName = chkTagFilter.getAttribute(\"data-filter\");\n                    var filters = query.Tags || \"\";\n                    var delimiter = \"|\";\n                    filters = (delimiter + filters).replace(delimiter + filterName, \"\").substring(1);\n                    if (chkTagFilter.checked) {\n                        filters = filters ? (filters + delimiter + filterName) : filterName;\n                    }\n                    query.StartIndex = 0;\n                    query.Tags = filters;\n                    triggerChange(self);\n                    return;\n                }\n                var chkYearFilter = parentWithClass(e.target, \"chkYearFilter\");\n                if (chkYearFilter) {\n                    var filterName = chkYearFilter.getAttribute(\"data-filter\");\n                    var filters = query.Years || \"\";\n                    var delimiter = \",\";\n                    filters = (delimiter + filters).replace(delimiter + filterName, \"\").substring(1);\n                    if (chkYearFilter.checked) {\n                        filters = filters ? (filters + delimiter + filterName) : filterName;\n                    }\n                    query.StartIndex = 0;\n                    query.Years = filters;\n                    triggerChange(self);\n                    return;\n                }\n                var chkOfficialRatingFilter = parentWithClass(e.target, \"chkOfficialRatingFilter\");\n                if (chkOfficialRatingFilter) {\n                    var filterName = chkOfficialRatingFilter.getAttribute(\"data-filter\");\n                    var filters = query.OfficialRatings || \"\";\n                    var delimiter = \"|\";\n                    filters = (delimiter + filters).replace(delimiter + filterName, \"\").substring(1);\n                    if (chkOfficialRatingFilter.checked) {\n                        filters = filters ? (filters + delimiter + filterName) : filterName;\n                    }\n                    query.StartIndex = 0;\n                    query.OfficialRatings = filters;\n                    triggerChange(self);\n                    return;\n                }\n            });\n        }\n\n        var self = this;\n\n        self.show = function () {\n            return new Promise(function (resolve, reject) {\n                require([\"text!./filterdialog.template.html\"], function (template) {\n                    var dlg = dialogHelper.createDialog({\n                        removeOnClose: true,\n                        modal: false\n                    });\n                    dlg.classList.add(\"ui-body-a\");\n                    dlg.classList.add(\"background-theme-a\");\n                    dlg.classList.add(\"formDialog\");\n                    dlg.classList.add(\"filterDialog\");\n                    dlg.innerHTML = globalize.translateDocument(template);\n                    setVisibility(dlg, options);\n                    dialogHelper.open(dlg);\n                    dlg.addEventListener(\"close\", resolve);\n                    updateFilterControls(dlg, options);\n                    bindEvents(dlg);\n                    if (enableDynamicFilters(options.mode)) {\n                        dlg.classList.add(\"dynamicFilterDialog\");\n                        var apiClient = connectionManager.getApiClient(options.serverId);\n                        loadDynamicFilters(dlg, apiClient, apiClient.getCurrentUserId(), options.query);\n                    }\n                });\n            });\n        };\n    };\n});\n"]}