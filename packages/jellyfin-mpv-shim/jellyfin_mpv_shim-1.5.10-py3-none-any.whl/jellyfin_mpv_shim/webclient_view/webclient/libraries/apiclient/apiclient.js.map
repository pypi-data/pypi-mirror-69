{"version":3,"sources":["libraries/apiclient/apiclient.js"],"names":["define","ApiClient","localassetmanager","window","appMode","isLocalId","str","startsWith","localPrefix","isLocalViewId","localViewPrefix","isTopLevelLocalViewId","stripLocalPrefix","res","stripStart","find","length","indexOf","substr","convertGuidToLocal","guid","adjustGuidProperties","downloadedItem","Id","SeriesId","SeasonId","AlbumId","ParentId","ParentThumbItemId","ParentPrimaryImageItemId","PrimaryImageItemId","ParentLogoItemId","ParentBackdropItemId","ParentBackdropImageTags","getLocalView","instance","serverId","userId","getLocalFolders","then","views","localView","Name","downloadsTitleText","ServerId","Type","IsFolder","Promise","resolve","ApiClientEx","serverAddress","clientName","applicationVersion","deviceName","deviceId","call","this","Object","assign","prototype","getPlaybackInfo","itemId","options","deviceProfile","onFailure","getLocalItem","item","MediaSources","Item","map","m","SupportsDirectPlay","SupportsDirectStream","SupportsTranscoding","IsLocal","mediaSources","fileExists","LocalPath","exists","getItems","i","serverInfo","items","result","Items","TotalRecordCount","AlbumIds","getViewItems","forEach","ExcludeItemIds","exItems","split","Ids","ids","hasLocal","getItemsFromIds","getUserViews","basePromise","enableLocalView","push","getItem","Error","toString","filter","reject","UserId","getViews","getNextUpEpisodes","getSeasons","IncludeItemTypes","SortBy","getCurrentUserId","getEpisodes","seasonId","getLatestOfflineItems","SortOrder","getThemeMedia","inherit","getSpecialFeatures","getSimilarItems","updateFavoriteStatus","isFavorite","getScaledImageUrl","itemid","id","getImageUrl","reportPlaybackStart","ItemId","reportPlaybackProgress","libraryItem","MediaType","UserData","PlaybackPositionTicks","PositionTicks","PlayedPercentage","Math","min","RunTimeTicks","addOrUpdateLocalItem","reportPlaybackStopped","action","Date","getTime","recordUserAction","getIntros","getInstantMixFromItem","getItemDownloadUrl"],"mappings":"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","file":"apiclient.js","sourcesContent":["//TODO: (vitorsemeano) modify this lines for webpack\ndefine([\"libraries/apiclient/apiclientcore\", \"localassetmanager\"], function(ApiClient, localassetmanager) {\n    \"use strict\";\n\n    if (\"cordova\" !== window.appMode && \"android\" !== window.appMode) {\n        return ApiClient;\n    }\n\n    function isLocalId(str) {\n        return startsWith(str, localPrefix)\n    }\n\n    function isLocalViewId(str) {\n        return startsWith(str, localViewPrefix)\n    }\n\n    function isTopLevelLocalViewId(str) {\n        return \"localview\" === str\n    }\n\n    function stripLocalPrefix(str) {\n        var res = stripStart(str, localPrefix);\n        return res = stripStart(res, localViewPrefix)\n    }\n\n    function startsWith(str, find) {\n        return !!(str && find && str.length > find.length && 0 === str.indexOf(find))\n    }\n\n    function stripStart(str, find) {\n        return startsWith(str, find) ? str.substr(find.length) : str\n    }\n\n    function createEmptyList() {\n        return {\n            Items: [],\n            TotalRecordCount: 0\n        }\n    }\n\n    function convertGuidToLocal(guid) {\n        return guid ? isLocalId(guid) ? guid : \"local:\" + guid : null\n    }\n\n    function adjustGuidProperties(downloadedItem) {\n        downloadedItem.Id = convertGuidToLocal(downloadedItem.Id), downloadedItem.SeriesId = convertGuidToLocal(downloadedItem.SeriesId), downloadedItem.SeasonId = convertGuidToLocal(downloadedItem.SeasonId), downloadedItem.AlbumId = convertGuidToLocal(downloadedItem.AlbumId), downloadedItem.ParentId = convertGuidToLocal(downloadedItem.ParentId), downloadedItem.ParentThumbItemId = convertGuidToLocal(downloadedItem.ParentThumbItemId), downloadedItem.ParentPrimaryImageItemId = convertGuidToLocal(downloadedItem.ParentPrimaryImageItemId), downloadedItem.PrimaryImageItemId = convertGuidToLocal(downloadedItem.PrimaryImageItemId), downloadedItem.ParentLogoItemId = convertGuidToLocal(downloadedItem.ParentLogoItemId), downloadedItem.ParentBackdropItemId = convertGuidToLocal(downloadedItem.ParentBackdropItemId), downloadedItem.ParentBackdropImageTags = null\n    }\n\n    function getLocalView(instance, serverId, userId) {\n        return instance.getLocalFolders(serverId, userId).then(function(views) {\n            var localView = null;\n            return views.length > 0 && (localView = {\n                Name: instance.downloadsTitleText || \"Downloads\",\n                ServerId: serverId,\n                Id: \"localview\",\n                Type: \"localview\",\n                IsFolder: !0\n            }), Promise.resolve(localView)\n        })\n    }\n\n    function ApiClientEx(serverAddress, clientName, applicationVersion, deviceName, deviceId) {\n        ApiClient.call(this, serverAddress, clientName, applicationVersion, deviceName, deviceId)\n    }\n    var localPrefix = \"local:\",\n        localViewPrefix = \"localview:\";\n    return Object.assign(ApiClientEx.prototype, ApiClient.prototype), ApiClientEx.prototype.getPlaybackInfo = function(itemId, options, deviceProfile) {\n        var onFailure = function() {\n            return ApiClient.prototype.getPlaybackInfo.call(instance, itemId, options, deviceProfile)\n        };\n        if (isLocalId(itemId)) return localassetmanager.getLocalItem(this.serverId(), stripLocalPrefix(itemId)).then(function(item) {\n            return {\n                MediaSources: item.Item.MediaSources.map(function(m) {\n                    return m.SupportsDirectPlay = !0, m.SupportsDirectStream = !1, m.SupportsTranscoding = !1, m.IsLocal = !0, m\n                })\n            }\n        }, onFailure);\n        var instance = this;\n        return localassetmanager.getLocalItem(this.serverId(), itemId).then(function(item) {\n            if (item) {\n                var mediaSources = item.Item.MediaSources.map(function(m) {\n                    return m.SupportsDirectPlay = !0, m.SupportsDirectStream = !1, m.SupportsTranscoding = !1, m.IsLocal = !0, m\n                });\n                return localassetmanager.fileExists(item.LocalPath).then(function(exists) {\n                    if (exists) {\n                        var res = {\n                            MediaSources: mediaSources\n                        };\n                        return Promise.resolve(res)\n                    }\n                    return ApiClient.prototype.getPlaybackInfo.call(instance, itemId, options, deviceProfile)\n                }, onFailure)\n            }\n            return ApiClient.prototype.getPlaybackInfo.call(instance, itemId, options, deviceProfile)\n        }, onFailure)\n    }, ApiClientEx.prototype.getItems = function(userId, options) {\n        var i, serverInfo = this.serverInfo();\n        if (serverInfo && \"localview\" === options.ParentId) return this.getLocalFolders(serverInfo.Id, userId).then(function(items) {\n            var result = {\n                Items: items,\n                TotalRecordCount: items.length\n            };\n            return Promise.resolve(result)\n        });\n        if (serverInfo && options && (isLocalId(options.ParentId) || isLocalId(options.SeriesId) || isLocalId(options.SeasonId) || isLocalViewId(options.ParentId) || isLocalId(options.AlbumIds))) return localassetmanager.getViewItems(serverInfo.Id, userId, options).then(function(items) {\n            items.forEach(function(item) {\n                adjustGuidProperties(item)\n            });\n            var result = {\n                Items: items,\n                TotalRecordCount: items.length\n            };\n            return Promise.resolve(result)\n        });\n        if (options && options.ExcludeItemIds && options.ExcludeItemIds.length) {\n            var exItems = options.ExcludeItemIds.split(\",\");\n            for (i = 0; i < exItems.length; i++)\n                if (isLocalId(exItems[i])) return Promise.resolve(createEmptyList())\n        } else if (options && options.Ids && options.Ids.length) {\n            var ids = options.Ids.split(\",\"),\n                hasLocal = !1;\n            for (i = 0; i < ids.length; i++) isLocalId(ids[i]) && (hasLocal = !0);\n            if (hasLocal) return localassetmanager.getItemsFromIds(serverInfo.Id, ids).then(function(items) {\n                items.forEach(function(item) {\n                    adjustGuidProperties(item)\n                });\n                var result = {\n                    Items: items,\n                    TotalRecordCount: items.length\n                };\n                return Promise.resolve(result)\n            })\n        }\n        return ApiClient.prototype.getItems.call(this, userId, options)\n    }, ApiClientEx.prototype.getUserViews = function(options, userId) {\n        var instance = this;\n        options = options || {};\n        var basePromise = ApiClient.prototype.getUserViews.call(instance, options, userId);\n        return options.enableLocalView ? basePromise.then(function(result) {\n            var serverInfo = instance.serverInfo();\n            return serverInfo ? getLocalView(instance, serverInfo.Id, userId).then(function(localView) {\n                return localView && (result.Items.push(localView), result.TotalRecordCount++), Promise.resolve(result)\n            }) : Promise.resolve(result)\n        }) : basePromise\n    }, ApiClientEx.prototype.getItem = function(userId, itemId) {\n        if (!itemId) throw new Error(\"null itemId\");\n        itemId && (itemId = itemId.toString());\n        var serverInfo;\n        return isTopLevelLocalViewId(itemId) && (serverInfo = this.serverInfo()) ? getLocalView(this, serverInfo.Id, userId) : isLocalViewId(itemId) && (serverInfo = this.serverInfo()) ? this.getLocalFolders(serverInfo.Id, userId).then(function(items) {\n            var views = items.filter(function(item) {\n                return item.Id === itemId\n            });\n            return views.length > 0 ? Promise.resolve(views[0]) : Promise.reject()\n        }) : isLocalId(itemId) && (serverInfo = this.serverInfo()) ? localassetmanager.getLocalItem(serverInfo.Id, stripLocalPrefix(itemId)).then(function(item) {\n            return adjustGuidProperties(item.Item), Promise.resolve(item.Item)\n        }) : ApiClient.prototype.getItem.call(this, userId, itemId)\n    }, ApiClientEx.prototype.getLocalFolders = function(userId) {\n        var serverInfo = this.serverInfo();\n        return userId = userId || serverInfo.UserId, localassetmanager.getViews(serverInfo.Id, userId)\n    }, ApiClientEx.prototype.getNextUpEpisodes = function(options) {\n        return options.SeriesId && isLocalId(options.SeriesId) ? Promise.resolve(createEmptyList()) : ApiClient.prototype.getNextUpEpisodes.call(this, options)\n    }, ApiClientEx.prototype.getSeasons = function(itemId, options) {\n        return isLocalId(itemId) ? (options.SeriesId = itemId, options.IncludeItemTypes = \"Season\", options.SortBy = \"SortName\", this.getItems(this.getCurrentUserId(), options)) : ApiClient.prototype.getSeasons.call(this, itemId, options)\n    }, ApiClientEx.prototype.getEpisodes = function(itemId, options) {\n        return isLocalId(options.SeasonId) || isLocalId(options.seasonId) ? (options.SeriesId = itemId, options.IncludeItemTypes = \"Episode\", options.SortBy = \"SortName\", this.getItems(this.getCurrentUserId(), options)) : isLocalId(itemId) ? (options.SeriesId = itemId, options.IncludeItemTypes = \"Episode\", options.SortBy = \"SortName\", this.getItems(this.getCurrentUserId(), options)) : ApiClient.prototype.getEpisodes.call(this, itemId, options)\n    }, ApiClientEx.prototype.getLatestOfflineItems = function(options) {\n        options.SortBy = \"DateCreated\", options.SortOrder = \"Descending\";\n        var serverInfo = this.serverInfo();\n        return serverInfo ? localassetmanager.getViewItems(serverInfo.Id, null, options).then(function(items) {\n            return items.forEach(function(item) {\n                adjustGuidProperties(item)\n            }), Promise.resolve(items)\n        }) : Promise.resolve([])\n    }, ApiClientEx.prototype.getThemeMedia = function(userId, itemId, inherit) {\n        return isLocalViewId(itemId) || isLocalId(itemId) || isTopLevelLocalViewId(itemId) ? Promise.reject() : ApiClient.prototype.getThemeMedia.call(this, userId, itemId, inherit)\n    }, ApiClientEx.prototype.getSpecialFeatures = function(userId, itemId) {\n        return isLocalId(itemId) ? Promise.resolve([]) : ApiClient.prototype.getSpecialFeatures.call(this, userId, itemId)\n    }, ApiClientEx.prototype.getSimilarItems = function(itemId, options) {\n        return isLocalId(itemId) ? Promise.resolve(createEmptyList()) : ApiClient.prototype.getSimilarItems.call(this, itemId, options)\n    }, ApiClientEx.prototype.updateFavoriteStatus = function(userId, itemId, isFavorite) {\n        return isLocalId(itemId) ? Promise.resolve() : ApiClient.prototype.updateFavoriteStatus.call(this, userId, itemId, isFavorite)\n    }, ApiClientEx.prototype.getScaledImageUrl = function(itemId, options) {\n        if (isLocalId(itemId) || options && options.itemid && isLocalId(options.itemid)) {\n            var serverInfo = this.serverInfo(),\n                id = stripLocalPrefix(itemId);\n            return localassetmanager.getImageUrl(serverInfo.Id, id, options)\n        }\n        return ApiClient.prototype.getScaledImageUrl.call(this, itemId, options)\n    }, ApiClientEx.prototype.reportPlaybackStart = function(options) {\n        if (!options) throw new Error(\"null options\");\n        return isLocalId(options.ItemId) ? Promise.resolve() : ApiClient.prototype.reportPlaybackStart.call(this, options)\n    }, ApiClientEx.prototype.reportPlaybackProgress = function(options) {\n        if (!options) throw new Error(\"null options\");\n        if (isLocalId(options.ItemId)) {\n            var serverInfo = this.serverInfo();\n            return serverInfo ? localassetmanager.getLocalItem(serverInfo.Id, stripLocalPrefix(options.ItemId)).then(function(item) {\n                var libraryItem = item.Item;\n                return \"Video\" === libraryItem.MediaType || \"AudioBook\" === libraryItem.Type ? (libraryItem.UserData = libraryItem.UserData || {}, libraryItem.UserData.PlaybackPositionTicks = options.PositionTicks, libraryItem.UserData.PlayedPercentage = Math.min(libraryItem.RunTimeTicks ? (options.PositionTicks || 0) / libraryItem.RunTimeTicks * 100 : 0, 100), localassetmanager.addOrUpdateLocalItem(item)) : Promise.resolve()\n            }) : Promise.resolve()\n        }\n        return ApiClient.prototype.reportPlaybackProgress.call(this, options)\n    }, ApiClientEx.prototype.reportPlaybackStopped = function(options) {\n        if (!options) throw new Error(\"null options\");\n        if (isLocalId(options.ItemId)) {\n            var serverInfo = this.serverInfo(),\n                action = {\n                    Date: (new Date).getTime(),\n                    ItemId: stripLocalPrefix(options.ItemId),\n                    PositionTicks: options.PositionTicks,\n                    ServerId: serverInfo.Id,\n                    Type: 0,\n                    UserId: this.getCurrentUserId()\n                };\n            return localassetmanager.recordUserAction(action)\n        }\n        return ApiClient.prototype.reportPlaybackStopped.call(this, options)\n    }, ApiClientEx.prototype.getIntros = function(itemId) {\n        return isLocalId(itemId) ? Promise.resolve({\n            Items: [],\n            TotalRecordCount: 0\n        }) : ApiClient.prototype.getIntros.call(this, itemId)\n    }, ApiClientEx.prototype.getInstantMixFromItem = function(itemId, options) {\n        return isLocalId(itemId) ? Promise.resolve({\n            Items: [],\n            TotalRecordCount: 0\n        }) : ApiClient.prototype.getInstantMixFromItem.call(this, itemId, options)\n    }, ApiClientEx.prototype.getItemDownloadUrl = function(itemId) {\n        if (isLocalId(itemId)) {\n            var serverInfo = this.serverInfo();\n            if (serverInfo) return localassetmanager.getLocalItem(serverInfo.Id, stripLocalPrefix(itemId)).then(function(item) {\n                return Promise.resolve(item.LocalPath)\n            })\n        }\n        return ApiClient.prototype.getItemDownloadUrl.call(this, itemId)\n    }, ApiClientEx\n});\n"]}