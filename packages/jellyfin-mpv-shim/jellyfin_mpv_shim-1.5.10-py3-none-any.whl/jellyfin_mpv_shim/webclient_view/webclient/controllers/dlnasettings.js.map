{"version":3,"sources":["controllers/dlnasettings.js"],"names":["define","$","loading","libraryMenu","onSubmit","show","form","this","ApiClient","getNamedConfiguration","then","config","EnablePlayTo","querySelector","checked","EnableDebugLog","ClientDiscoveryIntervalSeconds","val","EnableServer","BlastAliveMessages","BlastAliveMessageIntervalSeconds","DefaultUserId","updateNamedConfiguration","Dashboard","processServerConfigurationUpdateResult","getTabs","href","name","Globalize","translate","document","on","off","setTabs","page","promise1","promise2","getUsers","Promise","all","responses","loadPage","users","usersHtml","map","u","Id","Name","join","html","hide"],"mappings":"AAAA,aAAAA,OAAO,CAAC,SAAU,UAAW,cAAe,cAAc,SAAUC,EAAGC,QAASC,aAiB5E,SAASC,WACLF,QAAQG,OACR,IAAIC,KAAOC,KAWX,OAVAC,UAAUC,sBAAsB,QAAQC,MAAK,SAAUC,QACnDA,OAAOC,aAAeN,KAAKO,cAAc,oBAAoBC,QAC7DH,OAAOI,eAAiBT,KAAKO,cAAc,8BAA8BC,QACzEH,OAAOK,+BAAiCf,EAAE,8BAA+BK,MAAMW,MAC/EN,OAAOO,aAAejB,EAAE,mBAAoBK,MAAMQ,UAClDH,OAAOQ,mBAAqBlB,EAAE,yBAA0BK,MAAMQ,UAC9DH,OAAOS,iCAAmCnB,EAAE,oBAAqBK,MAAMW,MACvEN,OAAOU,cAAgBpB,EAAE,cAAeK,MAAMW,MAC9CT,UAAUc,yBAAyB,OAAQX,QAAQD,KAAKa,UAAUC,4CAE/D,EAGX,SAASC,UACL,MAAO,CAAC,CACJC,KAAM,oBACNC,KAAMC,UAAUC,UAAU,gBAC3B,CACCH,KAAM,oBACNC,KAAMC,UAAUC,UAAU,iBAIlC5B,EAAE6B,UAAUC,GAAG,WAAY,qBAAqB,WAC5C9B,EAAE,qBAAqB+B,IAAI,SAAU5B,UAAU2B,GAAG,SAAU3B,aAC7D2B,GAAG,WAAY,qBAAqB,WACnC5B,YAAY8B,QAAQ,OAAQ,EAAGR,SAC/BvB,QAAQG,OACR,IAAI6B,KAAO3B,KACP4B,SAAW3B,UAAUC,sBAAsB,QAC3C2B,SAAW5B,UAAU6B,WACzBC,QAAQC,IAAI,CAACJ,SAAUC,WAAW1B,MAAK,SAAU8B,YAhDrD,SAASC,SAASP,KAAMvB,OAAQ+B,OAC5BR,KAAKrB,cAAc,oBAAoBC,QAAUH,OAAOC,aACxDsB,KAAKrB,cAAc,8BAA8BC,QAAUH,OAAOI,eAClEd,EAAE,8BAA+BiC,MAAMjB,IAAIN,OAAOK,gCAClDf,EAAE,mBAAoBiC,MAAMpB,QAAQH,OAAOO,cAC3CjB,EAAE,yBAA0BiC,MAAMpB,QAAQH,OAAOQ,oBACjDlB,EAAE,oBAAqBiC,MAAMjB,IAAIN,OAAOS,kCACxC,IAAIuB,UAAYD,MAAME,KAAI,SAAUC,GAChC,MAAO,kBAAoBA,EAAEC,GAAK,KAAOD,EAAEE,KAAO,eACnDC,KAAK,IACR/C,EAAE,cAAeiC,MAAMe,KAAKN,WAAW1B,IAAIN,OAAOU,eAAiB,IACnEnB,QAAQgD,OAsCJT,CAASP,KAAMM,UAAU,GAAIA,UAAU","file":"dlnasettings.js","sourcesContent":["define([\"jQuery\", \"loading\", \"libraryMenu\", \"fnchecked\"], function ($, loading, libraryMenu) {\n    \"use strict\";\n\n    function loadPage(page, config, users) {\n        page.querySelector(\"#chkEnablePlayTo\").checked = config.EnablePlayTo;\n        page.querySelector(\"#chkEnableDlnaDebugLogging\").checked = config.EnableDebugLog;\n        $(\"#txtClientDiscoveryInterval\", page).val(config.ClientDiscoveryIntervalSeconds);\n        $(\"#chkEnableServer\", page).checked(config.EnableServer);\n        $(\"#chkBlastAliveMessages\", page).checked(config.BlastAliveMessages);\n        $(\"#txtBlastInterval\", page).val(config.BlastAliveMessageIntervalSeconds);\n        var usersHtml = users.map(function (u) {\n            return '<option value=\"' + u.Id + '\">' + u.Name + \"</option>\";\n        }).join(\"\");\n        $(\"#selectUser\", page).html(usersHtml).val(config.DefaultUserId || \"\");\n        loading.hide();\n    }\n\n    function onSubmit() {\n        loading.show();\n        var form = this;\n        ApiClient.getNamedConfiguration(\"dlna\").then(function (config) {\n            config.EnablePlayTo = form.querySelector(\"#chkEnablePlayTo\").checked;\n            config.EnableDebugLog = form.querySelector(\"#chkEnableDlnaDebugLogging\").checked;\n            config.ClientDiscoveryIntervalSeconds = $(\"#txtClientDiscoveryInterval\", form).val();\n            config.EnableServer = $(\"#chkEnableServer\", form).checked();\n            config.BlastAliveMessages = $(\"#chkBlastAliveMessages\", form).checked();\n            config.BlastAliveMessageIntervalSeconds = $(\"#txtBlastInterval\", form).val();\n            config.DefaultUserId = $(\"#selectUser\", form).val();\n            ApiClient.updateNamedConfiguration(\"dlna\", config).then(Dashboard.processServerConfigurationUpdateResult);\n        });\n        return false;\n    }\n\n    function getTabs() {\n        return [{\n            href: \"dlnasettings.html\",\n            name: Globalize.translate(\"TabSettings\")\n        }, {\n            href: \"dlnaprofiles.html\",\n            name: Globalize.translate(\"TabProfiles\")\n        }];\n    }\n\n    $(document).on(\"pageinit\", \"#dlnaSettingsPage\", function () {\n        $(\".dlnaSettingsForm\").off(\"submit\", onSubmit).on(\"submit\", onSubmit);\n    }).on(\"pageshow\", \"#dlnaSettingsPage\", function () {\n        libraryMenu.setTabs(\"dlna\", 0, getTabs);\n        loading.show();\n        var page = this;\n        var promise1 = ApiClient.getNamedConfiguration(\"dlna\");\n        var promise2 = ApiClient.getUsers();\n        Promise.all([promise1, promise2]).then(function (responses) {\n            loadPage(page, responses[0], responses[1]);\n        });\n    });\n});\n"]}