{"version":3,"sources":["scripts/browserdeviceprofile.js"],"names":["define","browser","canPlayH265","videoTestElement","options","tizen","orsay","xboxOne","web0s","supportsHevc","userAgent","navigator","toLowerCase","chromecast","indexOf","ps4","canPlayType","replace","_supportsTextTracks","_canPlayHls","canPlayHls","canPlayNativeHls","canPlayHlsWithMSE","window","MediaSource","media","document","createElement","canPlayAudioFormat","format","typeString","edgeUwp","iOS","osx","supportsMpeg2Video","supportsVc1","getDirectPlayProfileForVideoContainer","container","videoAudioCodecs","supported","profileContainer","videoCodecs","tizenVersion","push","chrome","testCanPlayTs","Container","Type","VideoCodec","join","AudioCodec","physicalAudioChannels","audioChannels","tv","canPlayVp8","canPlayVp9","webmAudioCodecs","canPlayMkv","testCanPlayMkv","operaTv","profile","MusicStreamingTranscodingBitrate","Math","min","DirectPlayProfiles","hlsVideoAudioCodecs","supportsMp3VideoAudio","supportsMp2VideoAudio","maxVideoWidth","self","screen","width","canPlayAacVideoAudio","supportsAc3","eAc3","supportsEac3","supportsAc3InHls","supportsDts","systeminfo","v","getCapability","parseFloat","supportsTrueHd","filter","c","disableVideoAudioCodecs","disableHlsVideoAudioCodecs","mp4VideoCodecs","hlsVideoCodecs","canPlayH264","length","map","i","forEach","audioFormat","TranscodingProfiles","hlsBreakOnNonKeyFrames","edge","enableHlsAudio","android","Context","Protocol","MaxAudioChannels","toString","MinSegments","BreakOnNonKeyFrames","enableMkvProgressive","CopyTimestamps","enableHls","ContainerProfiles","CodecProfiles","supportsSecondaryAudio","audioTracks","aacCodecProfileConditions","Condition","Property","Value","IsRequired","Codec","Conditions","maxH264Level","h264Profiles","safari","mobile","globalMaxVideoBitrate","getGlobalMaxVideoBitrate","isTizenFhd","webapis","productinfo","isUdPanelSupported","console","debug","error","code","h264MaxVideoBitrate","globalVideoConditions","SubtitleProfiles","supportsTextTracks","textTracks","Format","Method","ResponseProfiles","MimeType"],"mappings":"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","file":"browserdeviceprofile.js","sourcesContent":["define(['browser'], function (browser) {\n    'use strict';\n\n    function canPlayH264(videoTestElement) {\n        return !!(videoTestElement.canPlayType && videoTestElement.canPlayType('video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"').replace(/no/, ''));\n    }\n\n    function canPlayH265(videoTestElement, options) {\n        if (browser.tizen || browser.orsay || browser.xboxOne || browser.web0s || options.supportsHevc) {\n            return true;\n        }\n\n        var userAgent = navigator.userAgent.toLowerCase();\n        if (browser.chromecast) {\n            var isChromecastUltra = userAgent.indexOf('aarch64') !== -1;\n            if (isChromecastUltra) {\n                return true;\n            }\n        }\n\n        if (browser.ps4) {\n            return false;\n        }\n\n        return !!videoTestElement.canPlayType &&\n        (videoTestElement.canPlayType('video/mp4; codecs=\"hvc1.1.L120\"').replace(/no/, '') ||\n        videoTestElement.canPlayType('video/mp4; codecs=\"hev1.1.L120\"').replace(/no/, '') ||\n        videoTestElement.canPlayType('video/mp4; codecs=\"hvc1.1.0.L120\"').replace(/no/, '') ||\n        videoTestElement.canPlayType('video/mp4; codecs=\"hev1.1.0.L120\"').replace(/no/, ''));\n    }\n\n    var _supportsTextTracks;\n    function supportsTextTracks() {\n        if (browser.tizen || browser.orsay) {\n            return true;\n        }\n\n        if (_supportsTextTracks == null) {\n            _supportsTextTracks = document.createElement('video').textTracks != null;\n        }\n\n        // For now, until ready\n        return _supportsTextTracks;\n    }\n\n    var _canPlayHls;\n    function canPlayHls() {\n        if (_canPlayHls == null) {\n            _canPlayHls = canPlayNativeHls() || canPlayHlsWithMSE();\n        }\n\n        return _canPlayHls;\n    }\n\n    function canPlayNativeHls() {\n        if (browser.tizen || browser.orsay) {\n            return true;\n        }\n\n        var media = document.createElement('video');\n        if (media.canPlayType('application/x-mpegURL').replace(/no/, '') ||\n            media.canPlayType('application/vnd.apple.mpegURL').replace(/no/, '')) {\n            return true;\n        }\n\n        return false;\n    }\n\n    function canPlayHlsWithMSE() {\n        // text tracks donâ€™t work with this in firefox\n        return window.MediaSource != null;\n    }\n\n    function supportsAc3(videoTestElement) {\n        if (browser.edgeUwp || browser.tizen || browser.orsay || browser.web0s) {\n            return true;\n        }\n\n        return videoTestElement.canPlayType('audio/mp4; codecs=\"ac-3\"').replace(/no/, '');\n    }\n\n    function supportsEac3(videoTestElement) {\n        if (browser.tizen || browser.orsay || browser.web0s) {\n            return true;\n        }\n\n        return videoTestElement.canPlayType('audio/mp4; codecs=\"ec-3\"').replace(/no/, '');\n    }\n\n    function supportsAc3InHls(videoTestElement) {\n        if (browser.tizen || browser.orsay || browser.web0s) {\n            return true;\n        }\n\n        if (videoTestElement.canPlayType) {\n            return videoTestElement.canPlayType('application/x-mpegurl; codecs=\"avc1.42E01E, ac-3\"').replace(/no/, '') ||\n                videoTestElement.canPlayType('application/vnd.apple.mpegURL; codecs=\"avc1.42E01E, ac-3\"').replace(/no/, '');\n        }\n\n        return false;\n    }\n\n    function canPlayAudioFormat(format) {\n        var typeString;\n\n        if (format === 'flac') {\n            if (browser.tizen || browser.orsay || browser.web0s || browser.edgeUwp) {\n                return true;\n            }\n        } else if (format === 'wma') {\n            if (browser.tizen || browser.orsay || browser.edgeUwp) {\n                return true;\n            }\n        } else if (format === 'asf') {\n            if (browser.tizen || browser.web0s || browser.edgeUwp) {\n                return true;\n            }\n        } else if (format === 'opus') {\n            if (!browser.web0s) {\n                typeString = 'audio/ogg; codecs=\"opus\"';\n                return !!document.createElement('audio').canPlayType(typeString).replace(/no/, '');\n            }\n\n            return false;\n        } else if (format === 'alac') {\n            if (browser.iOS || browser.osx) {\n                return true;\n            }\n        } else if (format === 'mp2') {\n            // For now\n            return false;\n        }\n\n        if (format === 'webma') {\n            typeString = 'audio/webm';\n        } else if (format === 'mp2') {\n            typeString = 'audio/mpeg';\n        } else {\n            typeString = 'audio/' + format;\n        }\n\n        return !!document.createElement('audio').canPlayType(typeString).replace(/no/, '');\n    }\n\n    function testCanPlayMkv(videoTestElement) {\n        if (browser.tizen || browser.orsay || browser.web0s) {\n            return true;\n        }\n\n        if (videoTestElement.canPlayType('video/x-matroska').replace(/no/, '') ||\n            videoTestElement.canPlayType('video/mkv').replace(/no/, '')) {\n            return true;\n        }\n\n        // Unfortunately there's no real way to detect mkv support\n        if (browser.chrome) {\n            // Not supported on opera tv\n            if (browser.operaTv) {\n                return false;\n            }\n\n            var userAgent = navigator.userAgent.toLowerCase();\n\n            // Filter out browsers based on chromium that don't support mkv\n            if (userAgent.indexOf('vivaldi') !== -1 || userAgent.indexOf('opera') !== -1) {\n                return false;\n            }\n\n            return true;\n        }\n\n        if (browser.edgeUwp) {\n            return true;\n        }\n\n        return false;\n    }\n\n    function testCanPlayTs() {\n        return browser.tizen || browser.orsay || browser.web0s || browser.edgeUwp;\n    }\n\n    function supportsMpeg2Video() {\n        return browser.tizen || browser.orsay || browser.web0s || browser.edgeUwp;\n    }\n\n    function supportsVc1() {\n        return browser.tizen || browser.orsay || browser.web0s || browser.edgeUwp;\n    }\n\n    function getFlvMseDirectPlayProfile() {\n        var videoAudioCodecs = ['aac'];\n        if (!browser.edge && !browser.msie) {\n            videoAudioCodecs.push('mp3');\n        }\n\n        return {\n            Container: 'flv',\n            Type: 'Video',\n            VideoCodec: 'h264',\n            AudioCodec: videoAudioCodecs.join(',')\n        };\n    }\n\n    function getDirectPlayProfileForVideoContainer(container, videoAudioCodecs, videoTestElement, options) {\n        var supported = false;\n        var profileContainer = container;\n        var videoCodecs = [];\n\n        switch (container) {\n            case 'asf':\n                supported = browser.tizen || browser.orsay || browser.web0s || browser.edgeUwp;\n                videoAudioCodecs = [];\n                break;\n            case 'avi':\n                supported = browser.tizen || browser.orsay || browser.web0s || browser.edgeUwp;\n                // New Samsung TV don't support XviD/DivX\n                // Explicitly add supported codecs to make other codecs be transcoded\n                if (browser.tizenVersion >= 4) {\n                    videoCodecs.push('h264');\n                    if (canPlayH265(videoTestElement, options)) {\n                        videoCodecs.push('h265');\n                        videoCodecs.push('hevc');\n                    }\n                }\n                break;\n            case 'mpg':\n            case 'mpeg':\n                supported = browser.tizen || browser.orsay || browser.web0s || browser.edgeUwp;\n                break;\n            case 'flv':\n                supported = browser.tizen || browser.orsay;\n                //if (!supported && window.MediaSource != null && window.MediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"')) {\n                //    return getFlvMseDirectPlayProfile();\n                //}\n                break;\n            case '3gp':\n            case 'mts':\n            case 'trp':\n            case 'vob':\n            case 'vro':\n                supported = browser.tizen || browser.orsay;\n                break;\n            case 'mov':\n                supported = browser.tizen || browser.orsay || browser.web0s || browser.chrome || browser.edgeUwp;\n                videoCodecs.push('h264');\n                break;\n            case 'm2ts':\n                supported = browser.tizen || browser.orsay || browser.web0s || browser.edgeUwp;\n                videoCodecs.push('h264');\n                if (supportsVc1()) {\n                    videoCodecs.push('vc1');\n                }\n                if (supportsMpeg2Video()) {\n                    videoCodecs.push('mpeg2video');\n                }\n                break;\n            case 'wmv':\n                supported = browser.tizen || browser.orsay || browser.web0s || browser.edgeUwp;\n                videoAudioCodecs = [];\n                break;\n            case 'ts':\n                supported = testCanPlayTs();\n                videoCodecs.push('h264');\n                if (canPlayH265(videoTestElement, options)) {\n                    videoCodecs.push('h265');\n                    videoCodecs.push('hevc');\n                }\n                if (supportsVc1()) {\n                    videoCodecs.push('vc1');\n                }\n                if (supportsMpeg2Video()) {\n                    videoCodecs.push('mpeg2video');\n                }\n                profileContainer = 'ts,mpegts';\n                break;\n            default:\n                break;\n        }\n\n        return supported ? {\n            Container: profileContainer,\n            Type: 'Video',\n            VideoCodec: videoCodecs.join(','),\n            AudioCodec: videoAudioCodecs.join(',')\n        } : null;\n    }\n\n    function getMaxBitrate() {\n        return 120000000;\n    }\n\n    function getGlobalMaxVideoBitrate() {\n        var userAgent = navigator.userAgent.toLowerCase();\n        if (browser.chromecast) {\n            var isChromecastUltra = userAgent.indexOf('aarch64') !== -1;\n            if (isChromecastUltra) {\n                return null;\n            }\n\n            // This is a hack to try and detect chromecast on vizio\n            if (self.screen && self.screen.width >= 3800) {\n                return null;\n            }\n\n            return 30000000;\n        }\n\n        var isTizenFhd = false;\n        if (browser.tizen) {\n            try {\n                var isTizenUhd = webapis.productinfo.isUdPanelSupported();\n                isTizenFhd = !isTizenUhd;\n                console.debug(\"isTizenFhd = \" + isTizenFhd);\n            } catch (error) {\n                console.error(\"isUdPanelSupported() error code = \" + error.code);\n            }\n        }\n\n        return browser.ps4 ? 8000000 :\n            (browser.xboxOne ? 12000000 :\n                (browser.edgeUwp ? null :\n                    (browser.tizen && isTizenFhd ? 20000000 : null)));\n    }\n\n    return function (options) {\n        options = options || {};\n\n        var physicalAudioChannels = options.audioChannels || (browser.tv || browser.ps4 || browser.xboxOne ? 6 : 2);\n\n        var bitrateSetting = getMaxBitrate();\n\n        var videoTestElement = document.createElement('video');\n\n        var canPlayVp8 = videoTestElement.canPlayType('video/webm; codecs=\"vp8\"').replace(/no/, '');\n        var canPlayVp9 = videoTestElement.canPlayType('video/webm; codecs=\"vp9\"').replace(/no/, '');\n        var webmAudioCodecs = ['vorbis'];\n\n        var canPlayMkv = testCanPlayMkv(videoTestElement);\n\n        var profile = {};\n\n        profile.MaxStreamingBitrate = bitrateSetting;\n        profile.MaxStaticBitrate = 100000000;\n        profile.MusicStreamingTranscodingBitrate = Math.min(bitrateSetting, 192000);\n\n        profile.DirectPlayProfiles = [];\n\n        var videoAudioCodecs = [];\n        var hlsVideoAudioCodecs = [];\n\n        var supportsMp3VideoAudio = videoTestElement.canPlayType('video/mp4; codecs=\"avc1.640029, mp4a.69\"').replace(/no/, '') ||\n            videoTestElement.canPlayType('video/mp4; codecs=\"avc1.640029, mp4a.6B\"').replace(/no/, '');\n\n        // Not sure how to test for this\n        var supportsMp2VideoAudio = browser.edgeUwp || browser.tizen || browser.orsay || browser.web0s;\n\n        var maxVideoWidth = browser.xboxOne ?\n            (self.screen ? self.screen.width : null) :\n            null;\n\n        if (options.maxVideoWidth) {\n            maxVideoWidth = options.maxVideoWidth;\n        }\n\n        var canPlayAacVideoAudio = videoTestElement.canPlayType('video/mp4; codecs=\"avc1.640029, mp4a.40.2\"').replace(/no/, '');\n\n        if (canPlayAacVideoAudio && browser.chromecast && physicalAudioChannels <= 2) {\n            // prioritize this first\n            videoAudioCodecs.push('aac');\n        }\n\n        // Only put mp3 first if mkv support is there\n        // Otherwise with HLS and mp3 audio we're seeing some browsers\n        // safari is lying\n        if (supportsAc3(videoTestElement)) {\n\n            videoAudioCodecs.push('ac3');\n\n            var eAc3 = supportsEac3(videoTestElement);\n            if (eAc3) {\n                videoAudioCodecs.push('eac3');\n            }\n\n            // This works in edge desktop, but not mobile\n            // TODO: Retest this on mobile\n            if (supportsAc3InHls(videoTestElement)) {\n                hlsVideoAudioCodecs.push('ac3');\n                if (eAc3) {\n                    hlsVideoAudioCodecs.push('eac3');\n                }\n            }\n        }\n\n        if (canPlayAacVideoAudio && browser.chromecast && videoAudioCodecs.indexOf('aac') === -1) {\n            // prioritize this first\n            videoAudioCodecs.push('aac');\n        }\n\n        if (supportsMp3VideoAudio) {\n            videoAudioCodecs.push('mp3');\n\n            // PS4 fails to load HLS with mp3 audio\n            if (!browser.ps4) {\n                // mp3 encoder only supports 2 channels, so only make that preferred if we're only requesting 2 channels\n                // Also apply it for chromecast because it no longer supports AAC 5.1\n                if (physicalAudioChannels <= 2) {\n                    hlsVideoAudioCodecs.push('mp3');\n                }\n            }\n        }\n\n        if (canPlayAacVideoAudio) {\n            if (videoAudioCodecs.indexOf('aac') === -1) {\n                videoAudioCodecs.push('aac');\n            }\n\n            hlsVideoAudioCodecs.push('aac');\n        }\n\n        if (supportsMp3VideoAudio) {\n            // PS4 fails to load HLS with mp3 audio\n            if (!browser.ps4) {\n                if (hlsVideoAudioCodecs.indexOf('mp3') === -1) {\n                    hlsVideoAudioCodecs.push('mp3');\n                }\n            }\n        }\n\n        if (supportsMp2VideoAudio) {\n            videoAudioCodecs.push('mp2');\n        }\n\n        var supportsDts = browser.tizen || browser.orsay || browser.web0s || options.supportsDts;\n\n        if (self.tizen && self.tizen.systeminfo) {\n            var v = tizen.systeminfo.getCapability('http://tizen.org/feature/platform.version');\n\n            // DTS audio not supported in 2018 models (Tizen 4.0)\n            if (v && parseFloat(v) >= parseFloat('4.0')) {\n                supportsDts = false;\n            }\n        }\n\n        if (supportsDts) {\n            videoAudioCodecs.push('dca');\n            videoAudioCodecs.push('dts');\n        }\n\n        if (browser.tizen || browser.orsay || browser.web0s) {\n            videoAudioCodecs.push('pcm_s16le');\n            videoAudioCodecs.push('pcm_s24le');\n        }\n\n        if (options.supportsTrueHd) {\n            videoAudioCodecs.push('truehd');\n        }\n\n        if (browser.tizen || browser.orsay) {\n            videoAudioCodecs.push('aac_latm');\n        }\n\n        if (canPlayAudioFormat('opus')) {\n            videoAudioCodecs.push('opus');\n            hlsVideoAudioCodecs.push('opus');\n            webmAudioCodecs.push('opus');\n        }\n\n        if (canPlayAudioFormat('flac')) {\n            videoAudioCodecs.push('flac');\n        }\n\n        videoAudioCodecs = videoAudioCodecs.filter(function (c) {\n            return (options.disableVideoAudioCodecs || []).indexOf(c) === -1;\n        });\n\n        hlsVideoAudioCodecs = hlsVideoAudioCodecs.filter(function (c) {\n            return (options.disableHlsVideoAudioCodecs || []).indexOf(c) === -1;\n        });\n\n        var mp4VideoCodecs = [];\n        var hlsVideoCodecs = [];\n\n        if (canPlayH264(videoTestElement)) {\n            mp4VideoCodecs.push('h264');\n            hlsVideoCodecs.push('h264');\n        }\n\n        if (canPlayH265(videoTestElement, options)) {\n            mp4VideoCodecs.push('h265');\n            mp4VideoCodecs.push('hevc');\n\n            if (browser.tizen || browser.web0s) {\n                hlsVideoCodecs.push('h265');\n                hlsVideoCodecs.push('hevc');\n            }\n        }\n\n        if (supportsMpeg2Video()) {\n            mp4VideoCodecs.push('mpeg2video');\n        }\n\n        if (supportsVc1()) {\n            mp4VideoCodecs.push('vc1');\n        }\n\n        if (browser.tizen || browser.orsay) {\n            mp4VideoCodecs.push('msmpeg4v2');\n        }\n\n        if (canPlayVp8) {\n            mp4VideoCodecs.push('vp8');\n        }\n\n        if (canPlayVp9) {\n            mp4VideoCodecs.push('vp9');\n        }\n\n        if (canPlayVp8 || browser.tizen || browser.orsay) {\n            videoAudioCodecs.push('vorbis');\n        }\n\n        if (mp4VideoCodecs.length) {\n            profile.DirectPlayProfiles.push({\n                Container: 'mp4,m4v',\n                Type: 'Video',\n                VideoCodec: mp4VideoCodecs.join(','),\n                AudioCodec: videoAudioCodecs.join(',')\n            });\n        }\n\n        if (canPlayMkv && mp4VideoCodecs.length) {\n            profile.DirectPlayProfiles.push({\n                Container: 'mkv',\n                Type: 'Video',\n                VideoCodec: mp4VideoCodecs.join(','),\n                AudioCodec: videoAudioCodecs.join(',')\n            });\n        }\n\n        // These are formats we can't test for but some devices will support\n        ['m2ts', 'wmv', 'ts', 'asf', 'avi', 'mpg', 'mpeg', 'flv', '3gp', 'mts', 'trp', 'vob', 'vro', 'mov'].map(function (container) {\n            return getDirectPlayProfileForVideoContainer(container, videoAudioCodecs, videoTestElement, options);\n        }).filter(function (i) {\n            return i != null;\n        }).forEach(function (i) {\n            profile.DirectPlayProfiles.push(i);\n        });\n\n        ['opus', 'mp3', 'mp2', 'aac', 'flac', 'alac', 'webma', 'wma', 'wav', 'ogg', 'oga'].filter(canPlayAudioFormat).forEach(function (audioFormat) {\n\n            if (audioFormat === 'mp2') {\n                profile.DirectPlayProfiles.push({\n                    Container: 'mp2,mp3',\n                    Type: 'Audio',\n                    AudioCodec: audioFormat\n                });\n            } else if (audioFormat === 'mp3') {\n                profile.DirectPlayProfiles.push({\n                    Container: audioFormat,\n                    Type: 'Audio',\n                    AudioCodec: audioFormat\n                });\n            } else {\n                profile.DirectPlayProfiles.push({\n                    Container: audioFormat === 'webma' ? 'webma,webm' : audioFormat,\n                    Type: 'Audio'\n                });\n            }\n\n            // aac also appears in the m4a and m4b container\n            if (audioFormat === 'aac' || audioFormat === 'alac') {\n                profile.DirectPlayProfiles.push({\n                    Container: 'm4a,m4b',\n                    AudioCodec: audioFormat,\n                    Type: 'Audio'\n                });\n            }\n        });\n\n        if (canPlayVp8) {\n            profile.DirectPlayProfiles.push({\n                Container: 'webm',\n                Type: 'Video',\n                AudioCodec: webmAudioCodecs.join(','),\n                VideoCodec: 'VP8'\n            });\n        }\n\n        if (canPlayVp9) {\n            profile.DirectPlayProfiles.push({\n                Container: 'webm',\n                Type: 'Video',\n                AudioCodec: webmAudioCodecs.join(','),\n                VideoCodec: 'VP9'\n            });\n        }\n\n        profile.TranscodingProfiles = [];\n\n        var hlsBreakOnNonKeyFrames = browser.iOS || browser.osx || browser.edge || !canPlayNativeHls() ? true : false;\n\n        if (canPlayHls() && browser.enableHlsAudio !== false) {\n            profile.TranscodingProfiles.push({\n                // hlsjs, edge, and android all seem to require ts container\n                Container: !canPlayNativeHls() || browser.edge || browser.android ? 'ts' : 'aac',\n                Type: 'Audio',\n                AudioCodec: 'aac',\n                Context: 'Streaming',\n                Protocol: 'hls',\n                MaxAudioChannels: physicalAudioChannels.toString(),\n                MinSegments: browser.iOS || browser.osx ? '2' : '1',\n                BreakOnNonKeyFrames: hlsBreakOnNonKeyFrames\n            });\n        }\n\n        // For streaming, prioritize opus transcoding after mp3/aac. It is too problematic with random failures\n        // But for static (offline sync), it will be just fine.\n        // Prioritize aac higher because the encoder can accept more channels than mp3\n        ['aac', 'mp3', 'opus', 'wav'].filter(canPlayAudioFormat).forEach(function (audioFormat) {\n            profile.TranscodingProfiles.push({\n                Container: audioFormat,\n                Type: 'Audio',\n                AudioCodec: audioFormat,\n                Context: 'Streaming',\n                Protocol: 'http',\n                MaxAudioChannels: physicalAudioChannels.toString()\n            });\n        });\n\n        ['opus', 'mp3', 'aac', 'wav'].filter(canPlayAudioFormat).forEach(function (audioFormat) {\n            profile.TranscodingProfiles.push({\n                Container: audioFormat,\n                Type: 'Audio',\n                AudioCodec: audioFormat,\n                Context: 'Static',\n                Protocol: 'http',\n                MaxAudioChannels: physicalAudioChannels.toString()\n            });\n        });\n\n        if (canPlayMkv && !browser.tizen && !browser.orsay && options.enableMkvProgressive !== false) {\n            profile.TranscodingProfiles.push({\n                Container: 'mkv',\n                Type: 'Video',\n                AudioCodec: videoAudioCodecs.join(','),\n                VideoCodec: mp4VideoCodecs.join(','),\n                Context: 'Streaming',\n                MaxAudioChannels: physicalAudioChannels.toString(),\n                CopyTimestamps: true\n            });\n        }\n\n        if (canPlayMkv) {\n            profile.TranscodingProfiles.push({\n                Container: 'mkv',\n                Type: 'Video',\n                AudioCodec: videoAudioCodecs.join(','),\n                VideoCodec: mp4VideoCodecs.join(','),\n                Context: 'Static',\n                MaxAudioChannels: physicalAudioChannels.toString(),\n                CopyTimestamps: true\n            });\n        }\n\n        if (canPlayHls() && hlsVideoAudioCodecs.length && options.enableHls !== false) {\n            profile.TranscodingProfiles.push({\n                Container: 'ts',\n                Type: 'Video',\n                AudioCodec: hlsVideoAudioCodecs.join(','),\n                VideoCodec: hlsVideoCodecs.join(','),\n                Context: 'Streaming',\n                Protocol: 'hls',\n                MaxAudioChannels: physicalAudioChannels.toString(),\n                MinSegments: browser.iOS || browser.osx ? '2' : '1',\n                BreakOnNonKeyFrames: hlsBreakOnNonKeyFrames\n            });\n        }\n\n        if (canPlayVp8) {\n            profile.TranscodingProfiles.push({\n                Container: 'webm',\n                Type: 'Video',\n                AudioCodec: 'vorbis',\n                VideoCodec: 'vpx',\n                Context: 'Streaming',\n                Protocol: 'http',\n                // If audio transcoding is needed, limit channels to number of physical audio channels\n                // Trying to transcode to 5 channels when there are only 2 speakers generally does not sound good\n                MaxAudioChannels: physicalAudioChannels.toString()\n            });\n        }\n\n        profile.TranscodingProfiles.push({\n            Container: 'mp4',\n            Type: 'Video',\n            AudioCodec: videoAudioCodecs.join(','),\n            VideoCodec: 'h264',\n            Context: 'Static',\n            Protocol: 'http'\n        });\n\n        profile.ContainerProfiles = [];\n\n        profile.CodecProfiles = [];\n\n        var supportsSecondaryAudio = browser.tizen || browser.orsay || videoTestElement.audioTracks;\n\n        var aacCodecProfileConditions = [];\n\n        // Handle he-aac not supported\n        if (!videoTestElement.canPlayType('video/mp4; codecs=\"avc1.640029, mp4a.40.5\"').replace(/no/, '')) {\n            // TODO: This needs to become part of the stream url in order to prevent stream copy\n            aacCodecProfileConditions.push({\n                Condition: 'NotEquals',\n                Property: 'AudioProfile',\n                Value: 'HE-AAC'\n            });\n        }\n\n        if (!supportsSecondaryAudio) {\n            aacCodecProfileConditions.push({\n                Condition: 'Equals',\n                Property: 'IsSecondaryAudio',\n                Value: 'false',\n                IsRequired: false\n            });\n        }\n\n        if (browser.chromecast) {\n            aacCodecProfileConditions.push({\n                Condition: 'LessThanEqual',\n                Property: 'AudioChannels',\n                Value: '2',\n                IsRequired: true\n            });\n        }\n\n        if (aacCodecProfileConditions.length) {\n            profile.CodecProfiles.push({\n                Type: 'VideoAudio',\n                Codec: 'aac',\n                Conditions: aacCodecProfileConditions\n            });\n        }\n\n        if (!supportsSecondaryAudio) {\n            profile.CodecProfiles.push({\n                Type: 'VideoAudio',\n                Conditions: [\n                    {\n                        Condition: 'Equals',\n                        Property: 'IsSecondaryAudio',\n                        Value: 'false',\n                        IsRequired: false\n                    }\n                ]\n            });\n        }\n\n        var maxH264Level = 42;\n        var h264Profiles = 'high|main|baseline|constrained baseline';\n\n        if (browser.tizen || browser.orsay || browser.web0s ||\n            videoTestElement.canPlayType('video/mp4; codecs=\"avc1.640833\"').replace(/no/, '')) {\n            maxH264Level = 51;\n        }\n\n        if (browser.tizen || browser.orsay ||\n            videoTestElement.canPlayType('video/mp4; codecs=\"avc1.6e0033\"').replace(/no/, '')) {\n\n            // These tests are passing in safari, but playback is failing\n            if (!browser.safari && !browser.iOS && !browser.web0s && !browser.edge && !browser.mobile) {\n                h264Profiles += '|high 10';\n            }\n        }\n\n        profile.CodecProfiles.push({\n            Type: 'Video',\n            Codec: 'h264',\n            Conditions: [\n                {\n                    Condition: 'NotEquals',\n                    Property: 'IsAnamorphic',\n                    Value: 'true',\n                    IsRequired: false\n                },\n                {\n                    Condition: 'EqualsAny',\n                    Property: 'VideoProfile',\n                    Value: h264Profiles,\n                    IsRequired: false\n                },\n                {\n                    Condition: 'LessThanEqual',\n                    Property: 'VideoLevel',\n                    Value: maxH264Level.toString(),\n                    IsRequired: false\n                }\n            ]\n        });\n\n        if (!browser.edgeUwp && !browser.tizen && !browser.orsay && !browser.web0s) {\n            //profile.CodecProfiles[profile.CodecProfiles.length - 1].Conditions.push({\n            //    Condition: 'NotEquals',\n            //    Property: 'IsAVC',\n            //    Value: 'false',\n            //    IsRequired: false\n            //});\n\n            //profile.CodecProfiles[profile.CodecProfiles.length - 1].Conditions.push({\n            //    Condition: 'NotEquals',\n            //    Property: 'IsInterlaced',\n            //    Value: 'true',\n            //    IsRequired: false\n            //});\n        }\n\n        if (maxVideoWidth) {\n            profile.CodecProfiles[profile.CodecProfiles.length - 1].Conditions.push({\n                Condition: 'LessThanEqual',\n                Property: 'Width',\n                Value: maxVideoWidth.toString(),\n                IsRequired: false\n            });\n        }\n\n        var globalMaxVideoBitrate = (getGlobalMaxVideoBitrate() || '').toString();\n\n        var h264MaxVideoBitrate = globalMaxVideoBitrate;\n\n        if (h264MaxVideoBitrate) {\n            profile.CodecProfiles[profile.CodecProfiles.length - 1].Conditions.push({\n                Condition: 'LessThanEqual',\n                Property: 'VideoBitrate',\n                Value: h264MaxVideoBitrate,\n                IsRequired: true\n            });\n        }\n\n        var globalVideoConditions = [];\n\n        if (globalMaxVideoBitrate) {\n            globalVideoConditions.push({\n                Condition: 'LessThanEqual',\n                Property: 'VideoBitrate',\n                Value: globalMaxVideoBitrate\n            });\n        }\n\n        if (maxVideoWidth) {\n            globalVideoConditions.push({\n                Condition: 'LessThanEqual',\n                Property: 'Width',\n                Value: maxVideoWidth.toString(),\n                IsRequired: false\n            });\n        }\n\n        if (globalVideoConditions.length) {\n            profile.CodecProfiles.push({\n                Type: 'Video',\n                Conditions: globalVideoConditions\n            });\n        }\n\n        if (browser.chromecast) {\n            profile.CodecProfiles.push({\n                Type: 'Audio',\n                Codec: 'flac',\n                Conditions: [\n                    {\n                        Condition: 'LessThanEqual',\n                        Property: 'AudioSampleRate',\n                        Value: '96000'\n                    }]\n            });\n        }\n\n        // Subtitle profiles\n        // External vtt or burn in\n        profile.SubtitleProfiles = [];\n        if (supportsTextTracks()) {\n            profile.SubtitleProfiles.push({\n                Format: 'vtt',\n                Method: 'External'\n            });\n        }\n\n        profile.ResponseProfiles = [];\n        profile.ResponseProfiles.push({\n            Type: 'Video',\n            Container: 'm4v',\n            MimeType: 'video/mp4'\n        });\n\n        return profile;\n    };\n});\n"]}