{"version":3,"sources":["components/itemhelper.js"],"names":["define","appHost","globalize","canEdit","user","item","itemType","Type","Status","isLocalItem","Policy","IsAdministrator","Id","indexOf","getDisplayName","options","Error","ProgramInfo","name","IsSeries","EpisodeTitle","Name","ChannelNumber","ParentIndexNumber","translate","IndexNumber","includeIndexNumber","displayIndexNumber","number","nameSeparator","includeParentInfo","IndexNumberEnd","supportsAddingToCollection","CollectionType","MediaType","supportsAddingToPlaylist","IsFolder","canIdentify","canEditImages","canSync","EnableContentDownloading","SupportsSync","canShare","EnablePublicSharing","supports","enableDateAddedDisplay","canMarkPlayed","canRate","UserData","canConvert","EnableMediaConversion","mediaType","type","LocationType","IsPlaceHolder","canRefreshMetadata","supportsMediaSourceSelection","MediaSources","length","EnableMediaSourceDisplay","SourceType"],"mappings":"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","file":"itemhelper.js","sourcesContent":["define(['apphost', 'globalize'], function (appHost, globalize) {\n    'use strict';\n\n    function getDisplayName(item, options) {\n\n        if (!item) {\n            throw new Error(\"null item passed into getDisplayName\");\n        }\n\n        options = options || {};\n\n        if (item.Type === 'Timer') {\n            item = item.ProgramInfo || item;\n        }\n\n        var name = ((item.Type === 'Program' || item.Type === 'Recording') && (item.IsSeries || item.EpisodeTitle) ? item.EpisodeTitle : item.Name) || '';\n\n        if (item.Type === \"TvChannel\") {\n            if (item.ChannelNumber) {\n                return item.ChannelNumber + ' ' + name;\n            }\n            return name;\n        }\n        if (item.Type === \"Episode\" && item.ParentIndexNumber === 0) {\n            name = globalize.translate('ValueSpecialEpisodeName', name);\n        } else if ((item.Type === \"Episode\" || item.Type === 'Program') && item.IndexNumber != null && item.ParentIndexNumber != null && options.includeIndexNumber !== false) {\n\n            var displayIndexNumber = item.IndexNumber;\n\n            var number = displayIndexNumber;\n            var nameSeparator = \" - \";\n\n            if (options.includeParentInfo !== false) {\n                number = \"S\" + item.ParentIndexNumber + \":E\" + number;\n            } else {\n                nameSeparator = \". \";\n            }\n\n            if (item.IndexNumberEnd) {\n\n                displayIndexNumber = item.IndexNumberEnd;\n                number += \"-\" + displayIndexNumber;\n            }\n\n            if (number) {\n                name = name ? (number + nameSeparator + name) : number;\n            }\n        }\n\n        return name;\n    }\n\n    function supportsAddingToCollection(item) {\n\n        var invalidTypes = ['Genre', 'MusicGenre', 'Studio', 'UserView', 'CollectionFolder', 'Audio', 'Program', 'Timer', 'SeriesTimer'];\n\n        if (item.Type === 'Recording') {\n            if (item.Status !== 'Completed') {\n                return false;\n            }\n        }\n\n        return !item.CollectionType && invalidTypes.indexOf(item.Type) === -1 && item.MediaType !== 'Photo' && !isLocalItem(item);\n    }\n\n    function supportsAddingToPlaylist(item) {\n\n        if (item.Type === 'Program') {\n            return false;\n        }\n        if (item.Type === 'TvChannel') {\n            return false;\n        }\n        if (item.Type === 'Timer') {\n            return false;\n        }\n        if (item.Type === 'SeriesTimer') {\n            return false;\n        }\n        if (item.MediaType === 'Photo') {\n            return false;\n        }\n\n        if (item.Type === 'Recording') {\n            if (item.Status !== 'Completed') {\n                return false;\n            }\n        }\n\n        if (isLocalItem(item)) {\n            return false;\n        }\n        if (item.CollectionType === 'livetv') {\n            return false;\n        }\n\n        return item.MediaType || item.IsFolder || item.Type === \"Genre\" || item.Type === \"MusicGenre\" || item.Type === \"MusicArtist\";\n    }\n\n    function canEdit(user, item) {\n\n        var itemType = item.Type;\n\n        if (itemType === \"UserRootFolder\" || itemType === \"UserView\") {\n            return false;\n        }\n\n        if (itemType === 'Program') {\n            return false;\n        }\n\n        if (itemType === 'Timer') {\n            return false;\n        }\n\n        if (itemType === 'SeriesTimer') {\n            return false;\n        }\n\n        if (item.Type === 'Recording') {\n            if (item.Status !== 'Completed') {\n                return false;\n            }\n        }\n\n        if (isLocalItem(item)) {\n            return false;\n        }\n\n        return user.Policy.IsAdministrator;\n    }\n\n    function isLocalItem(item) {\n\n        if (item && item.Id && item.Id.indexOf('local') === 0) {\n            return true;\n        }\n\n        return false;\n    }\n\n    return {\n        getDisplayName: getDisplayName,\n        supportsAddingToCollection: supportsAddingToCollection,\n        supportsAddingToPlaylist: supportsAddingToPlaylist,\n        isLocalItem: isLocalItem,\n\n        canIdentify: function (user, item) {\n\n            var itemType = item.Type;\n\n            if (itemType === \"Movie\" ||\n                itemType === \"Trailer\" ||\n                itemType === \"Series\" ||\n                itemType === \"BoxSet\" ||\n                itemType === \"Person\" ||\n                itemType === \"Book\" ||\n                itemType === \"MusicAlbum\" ||\n                itemType === \"MusicArtist\" ||\n                itemType === \"MusicVideo\") {\n\n                if (user.Policy.IsAdministrator) {\n\n                    if (!isLocalItem(item)) {\n                        return true;\n                    }\n                }\n            }\n\n            return false;\n        },\n\n        canEdit: canEdit,\n\n        canEditImages: function (user, item) {\n\n            var itemType = item.Type;\n\n            if (item.MediaType === 'Photo') {\n                return false;\n            }\n\n            if (itemType === 'UserView') {\n                if (user.Policy.IsAdministrator) {\n\n                    return true;\n                }\n\n                return false;\n            }\n\n            if (item.Type === 'Recording') {\n                if (item.Status !== 'Completed') {\n                    return false;\n                }\n            }\n\n            return itemType !== 'Timer' && itemType !== 'SeriesTimer' && canEdit(user, item) && !isLocalItem(item);\n        },\n\n        canSync: function (user, item) {\n\n            if (user && !user.Policy.EnableContentDownloading) {\n                return false;\n            }\n\n            if (isLocalItem(item)) {\n                return false;\n            }\n\n            return item.SupportsSync;\n        },\n\n        canShare: function (item, user) {\n\n            if (item.Type === 'Program') {\n                return false;\n            }\n            if (item.Type === 'TvChannel') {\n                return false;\n            }\n            if (item.Type === 'Timer') {\n                return false;\n            }\n            if (item.Type === 'SeriesTimer') {\n                return false;\n            }\n            if (item.Type === 'Recording') {\n                if (item.Status !== 'Completed') {\n                    return false;\n                }\n            }\n            if (isLocalItem(item)) {\n                return false;\n            }\n            return user.Policy.EnablePublicSharing && appHost.supports('sharing');\n        },\n\n        enableDateAddedDisplay: function (item) {\n            return !item.IsFolder && item.MediaType && item.Type !== 'Program' && item.Type !== 'TvChannel' && item.Type !== 'Trailer';\n        },\n\n        canMarkPlayed: function (item) {\n\n            if (item.Type === 'Program') {\n                return false;\n            }\n\n            if (item.MediaType === 'Video') {\n                if (item.Type !== 'TvChannel') {\n                    return true;\n                }\n            } else if (item.MediaType === 'Audio') {\n                if (item.Type === 'AudioPodcast') {\n                    return true;\n                }\n                if (item.Type === 'AudioBook') {\n                    return true;\n                }\n            }\n\n            if (item.Type === \"Series\" ||\n                item.Type === \"Season\" ||\n                item.Type === \"BoxSet\" ||\n                item.MediaType === \"Book\" ||\n                item.MediaType === \"Recording\") {\n                return true;\n            }\n\n            return false;\n        },\n\n        canRate: function (item) {\n\n            if (item.Type === 'Program'\n                || item.Type === 'Timer'\n                || item.Type === 'SeriesTimer'\n                || item.Type === 'CollectionFolder'\n                || item.Type === 'UserView'\n                || item.Type === 'Channel'\n                || !item.UserData) {\n                return false;\n            }\n\n            return true;\n        },\n\n        canConvert: function (item, user) {\n\n            if (!user.Policy.EnableMediaConversion) {\n                return false;\n            }\n\n            if (isLocalItem(item)) {\n                return false;\n            }\n\n            var mediaType = item.MediaType;\n            if (mediaType === 'Book' || mediaType === 'Photo' || mediaType === 'Audio') {\n                return false;\n            }\n\n            var collectionType = item.CollectionType;\n            if (collectionType === 'livetv') {\n                return false;\n            }\n\n            var type = item.Type;\n            if (type === 'Channel' || type === 'Person' || type === 'Year' || type === 'Program' || type === 'Timer' || type === 'SeriesTimer') {\n                return false;\n            }\n\n            if (item.LocationType === 'Virtual' && !item.IsFolder) {\n                return false;\n            }\n\n            if (item.IsPlaceHolder) {\n                return false;\n            }\n\n            return true;\n        },\n\n        canRefreshMetadata: function (item, user) {\n\n            if (user.Policy.IsAdministrator) {\n\n                var collectionType = item.CollectionType;\n                if (collectionType === 'livetv') {\n                    return false;\n                }\n\n                if (item.Type !== 'Timer' && item.Type !== 'SeriesTimer' && item.Type !== 'Program' && item.Type !== 'TvChannel' && !(item.Type === 'Recording' && item.Status !== 'Completed')) {\n\n                    if (!isLocalItem(item)) {\n                        return true;\n                    }\n                }\n            }\n\n            return false;\n        },\n\n        supportsMediaSourceSelection: function (item) {\n\n            if (item.MediaType !== 'Video') {\n                return false;\n            }\n            if (item.Type === 'TvChannel') {\n                return false;\n            }\n            if (!item.MediaSources || (item.MediaSources.length === 1 && item.MediaSources[0].Type === 'Placeholder')) {\n                return false;\n            }\n            if (item.EnableMediaSourceDisplay === false) {\n                return false;\n            }\n            if (item.EnableMediaSourceDisplay == null && item.SourceType && item.SourceType !== 'Library') {\n                return false;\n            }\n\n            return true;\n        }\n    };\n});\n"]}