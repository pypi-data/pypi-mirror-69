{"version":3,"sources":["controllers/user/subtitles.js"],"names":["define","SubtitleSettings","userSettingsBuilder","currentUserSettings","autoFocuser","view","params","onBeforeUnload","e","hasChanges","returnValue","subtitleSettingsInstance","userId","ApiClient","getCurrentUserId","userSettings","addEventListener","window","loadData","serverId","element","querySelector","enableSaveButton","enableSaveConfirmation","autoFocus","isEnabled","submit","destroy"],"mappings":"AAAA,aAAAA,OAAO,CAAC,mBAAoB,sBAAuB,eAAgB,gBAAgB,SAAUC,iBAAkBC,oBAAqBC,oBAAqBC,aAGrJ,OAAO,SAAUC,KAAMC,QACnB,SAASC,eAAeC,GAChBC,aACAD,EAAEE,YAAc,uEAIxB,IAAIC,yBACAF,WACAG,OAASN,OAAOM,QAAUC,UAAUC,mBACpCC,aAAeH,SAAWC,UAAUC,mBAAqBX,oBAAsB,IAAID,oBACvFG,KAAKW,iBAAiB,YAAY,WAC9BC,OAAOD,iBAAiB,eAAgBT,gBAEpCI,yBACAA,yBAAyBO,WAEzBP,yBAA2B,IAAIV,iBAAiB,CAC5CkB,SAAUN,UAAUM,WACpBP,OAAQA,OACRQ,QAASf,KAAKgB,cAAc,sBAC5BN,aAAcA,aACdO,kBAAkB,EAClBC,wBAAwB,EACxBC,UAAWpB,YAAYqB,iBAInCpB,KAAKW,iBAAiB,UAAU,WAC5BP,YAAa,KAEjBJ,KAAKW,iBAAiB,kBAAkB,WACpCP,YAAa,EAETE,0BACAA,yBAAyBe,YAGjCrB,KAAKW,iBAAiB,eAAe,WAC7BL,2BACAA,yBAAyBgB,UACzBhB,yBAA2B","file":"subtitles.js","sourcesContent":["define([\"subtitleSettings\", \"userSettingsBuilder\", \"userSettings\", \"autoFocuser\"], function (SubtitleSettings, userSettingsBuilder, currentUserSettings, autoFocuser) {\n    \"use strict\";\n\n    return function (view, params) {\n        function onBeforeUnload(e) {\n            if (hasChanges) {\n                e.returnValue = \"You currently have unsaved changes. Are you sure you wish to leave?\";\n            }\n        }\n\n        var subtitleSettingsInstance;\n        var hasChanges;\n        var userId = params.userId || ApiClient.getCurrentUserId();\n        var userSettings = userId === ApiClient.getCurrentUserId() ? currentUserSettings : new userSettingsBuilder();\n        view.addEventListener(\"viewshow\", function () {\n            window.addEventListener(\"beforeunload\", onBeforeUnload);\n\n            if (subtitleSettingsInstance) {\n                subtitleSettingsInstance.loadData();\n            } else {\n                subtitleSettingsInstance = new SubtitleSettings({\n                    serverId: ApiClient.serverId(),\n                    userId: userId,\n                    element: view.querySelector(\".settingsContainer\"),\n                    userSettings: userSettings,\n                    enableSaveButton: false,\n                    enableSaveConfirmation: false,\n                    autoFocus: autoFocuser.isEnabled()\n                });\n            }\n        });\n        view.addEventListener(\"change\", function () {\n            hasChanges = true;\n        });\n        view.addEventListener(\"viewbeforehide\", function () {\n            hasChanges = false;\n\n            if (subtitleSettingsInstance) {\n                subtitleSettingsInstance.submit();\n            }\n        });\n        view.addEventListener(\"viewdestroy\", function () {\n            if (subtitleSettingsInstance) {\n                subtitleSettingsInstance.destroy();\n                subtitleSettingsInstance = null;\n            }\n        });\n    };\n});\n"]}