{"version":3,"sources":["controllers/user/playback.js"],"names":["define","PlaybackSettings","userSettingsBuilder","dom","globalize","loading","currentUserSettings","autoFocuser","view","params","onBeforeUnload","e","hasChanges","returnValue","settingsInstance","userId","ApiClient","getCurrentUserId","userSettings","addEventListener","window","loadData","serverId","element","querySelector","enableSaveButton","enableSaveConfirmation","autoFocus","isEnabled","submit","destroy"],"mappings":"AAAA,aAAAA,OAAO,CAAC,mBAAoB,sBAAuB,MAAO,YAAa,UAAW,eAAgB,cAAe,kBAAkB,SAAUC,iBAAkBC,oBAAqBC,IAAKC,UAAWC,QAASC,oBAAqBC,aAG9N,OAAO,SAAUC,KAAMC,QACnB,SAASC,eAAeC,GAChBC,aACAD,EAAEE,YAAc,uEAIxB,IAAIC,iBACAF,WACAG,OAASN,OAAOM,QAAUC,UAAUC,mBACpCC,aAAeH,SAAWC,UAAUC,mBAAqBX,oBAAsB,IAAIJ,oBACvFM,KAAKW,iBAAiB,YAAY,WAC9BC,OAAOD,iBAAiB,eAAgBT,gBAEpCI,iBACAA,iBAAiBO,WAEjBP,iBAAmB,IAAIb,iBAAiB,CACpCqB,SAAUN,UAAUM,WACpBP,OAAQA,OACRQ,QAASf,KAAKgB,cAAc,sBAC5BN,aAAcA,aACdO,kBAAkB,EAClBC,wBAAwB,EACxBC,UAAWpB,YAAYqB,iBAInCpB,KAAKW,iBAAiB,UAAU,WAC5BP,YAAa,KAEjBJ,KAAKW,iBAAiB,kBAAkB,WACpCP,YAAa,EAETE,kBACAA,iBAAiBe,YAGzBrB,KAAKW,iBAAiB,eAAe,WAC7BL,mBACAA,iBAAiBgB,UACjBhB,iBAAmB","file":"playback.js","sourcesContent":["define([\"playbackSettings\", \"userSettingsBuilder\", \"dom\", \"globalize\", \"loading\", \"userSettings\", \"autoFocuser\", \"listViewStyle\"], function (PlaybackSettings, userSettingsBuilder, dom, globalize, loading, currentUserSettings, autoFocuser) {\n    \"use strict\";\n\n    return function (view, params) {\n        function onBeforeUnload(e) {\n            if (hasChanges) {\n                e.returnValue = \"You currently have unsaved changes. Are you sure you wish to leave?\";\n            }\n        }\n\n        var settingsInstance;\n        var hasChanges;\n        var userId = params.userId || ApiClient.getCurrentUserId();\n        var userSettings = userId === ApiClient.getCurrentUserId() ? currentUserSettings : new userSettingsBuilder();\n        view.addEventListener(\"viewshow\", function () {\n            window.addEventListener(\"beforeunload\", onBeforeUnload);\n\n            if (settingsInstance) {\n                settingsInstance.loadData();\n            } else {\n                settingsInstance = new PlaybackSettings({\n                    serverId: ApiClient.serverId(),\n                    userId: userId,\n                    element: view.querySelector(\".settingsContainer\"),\n                    userSettings: userSettings,\n                    enableSaveButton: false,\n                    enableSaveConfirmation: false,\n                    autoFocus: autoFocuser.isEnabled()\n                });\n            }\n        });\n        view.addEventListener(\"change\", function () {\n            hasChanges = true;\n        });\n        view.addEventListener(\"viewbeforehide\", function () {\n            hasChanges = false;\n\n            if (settingsInstance) {\n                settingsInstance.submit();\n            }\n        });\n        view.addEventListener(\"viewdestroy\", function () {\n            if (settingsInstance) {\n                settingsInstance.destroy();\n                settingsInstance = null;\n            }\n        });\n    };\n});\n"]}