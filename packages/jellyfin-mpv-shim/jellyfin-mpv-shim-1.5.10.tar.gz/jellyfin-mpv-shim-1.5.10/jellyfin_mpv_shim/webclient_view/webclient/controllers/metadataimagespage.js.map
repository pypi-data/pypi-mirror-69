{"version":3,"sources":["controllers/metadataimagespage.js"],"names":["define","$","dom","loading","libraryMenu","populateCountries","select","ApiClient","getCountries","then","allCountries","html","i","length","culture","TwoLetterISORegionName","DisplayName","innerHTML","onSubmit","form","this","show","getServerConfiguration","config","PreferredMetadataLanguage","querySelector","value","MetadataCountryCode","updateServerConfiguration","Dashboard","processServerConfigurationUpdateResult","getTabs","href","name","Globalize","translate","document","on","off","setTabs","loadPage","page","promises","getCultures","languages","TwoLetterISOLanguageName","Promise","all","responses","hide"],"mappings":"AAAA,aAAAA,OAAO,CAAC,SAAU,MAAO,UAAW,cAAe,kBAAkB,SAASC,EAAGC,IAAKC,QAASC,aAe3F,SAASC,kBAAkBC,QACvB,OAAOC,UAAUC,eAAeC,MAAK,SAASC,cAC1C,IAAIC,KAAO,GACXA,MAAQ,6BACR,IAAK,IAAIC,EAAI,EAAGC,OAASH,aAAaG,OAAQD,EAAIC,OAAQD,IAAK,CAC3D,IAAIE,QAAUJ,aAAaE,GAC3BD,MAAQ,kBAAoBG,QAAQC,uBAAyB,KAAOD,QAAQE,YAAc,YAE9FV,OAAOW,UAAYN,QAY3B,SAASO,WACL,IAAIC,KAAOC,KACX,OAAOjB,QAAQkB,OAAQd,UAAUe,yBAAyBb,MAAK,SAASc,QACpEA,OAAOC,0BAA4BL,KAAKM,cAAc,mBAAmBC,MAAOH,OAAOI,oBAAsBR,KAAKM,cAAc,kBAAkBC,MAAOnB,UAAUqB,0BAA0BL,QAAQd,KAAKoB,UAAUC,4CACpN,EAGR,SAASC,UACL,MAAO,CAAC,CACJC,KAAM,eACNC,KAAMC,UAAUC,UAAU,oBAC3B,CACCH,KAAM,sBACNC,KAAMC,UAAUC,UAAU,eAC3B,CACCH,KAAM,sBACNC,KAAMC,UAAUC,UAAU,gBAC3B,CACCH,KAAM,mBACNC,KAAMC,UAAUC,UAAU,oBAIlClC,EAAEmC,UAAUC,GAAG,WAAY,oCAAoC,WAC3DpC,EAAE,oCAAoCqC,IAAI,SAAUpB,UAAUmB,GAAG,SAAUnB,aAC5EmB,GAAG,WAAY,oCAAoC,WAClDjC,YAAYmC,QAAQ,WAAY,EAAGR,SAAU5B,QAAQkB,OAlCzD,SAASmB,SAASC,MACd,IAzBuBnC,OAyBnBoC,SAAW,CAACnC,UAAUe,0BAzBHhB,OAyB+CmC,KAAKhB,cAAc,mBAxBlFlB,UAAUoC,cAAclC,MAAK,SAASmC,WACzC,IAAIjC,KAAO,GACXA,MAAQ,6BACR,IAAK,IAAIC,EAAI,EAAGC,OAAS+B,UAAU/B,OAAQD,EAAIC,OAAQD,IAAK,CACxD,IAAIE,QAAU8B,UAAUhC,GACxBD,MAAQ,kBAAoBG,QAAQ+B,yBAA2B,KAAO/B,QAAQE,YAAc,YAEhGV,OAAOW,UAAYN,SAiBuFN,kBAAkBoC,KAAKhB,cAAc,oBACnJqB,QAAQC,IAAIL,UAAUjC,MAAK,SAASuC,WAChC,IAAIzB,OAASyB,UAAU,GACvBP,KAAKhB,cAAc,mBAAmBC,MAAQH,OAAOC,2BAA6B,GAAIiB,KAAKhB,cAAc,kBAAkBC,MAAQH,OAAOI,qBAAuB,GAAIxB,QAAQ8C,UA8BpHT,CAASpB","file":"metadataimagespage.js","sourcesContent":["define([\"jQuery\", \"dom\", \"loading\", \"libraryMenu\", \"listViewStyle\"], function($, dom, loading, libraryMenu) {\n    \"use strict\";\n\n    function populateLanguages(select) {\n        return ApiClient.getCultures().then(function(languages) {\n            var html = \"\";\n            html += \"<option value=''></option>\";\n            for (var i = 0, length = languages.length; i < length; i++) {\n                var culture = languages[i];\n                html += \"<option value='\" + culture.TwoLetterISOLanguageName + \"'>\" + culture.DisplayName + \"</option>\"\n            }\n            select.innerHTML = html\n        })\n    }\n\n    function populateCountries(select) {\n        return ApiClient.getCountries().then(function(allCountries) {\n            var html = \"\";\n            html += \"<option value=''></option>\";\n            for (var i = 0, length = allCountries.length; i < length; i++) {\n                var culture = allCountries[i];\n                html += \"<option value='\" + culture.TwoLetterISORegionName + \"'>\" + culture.DisplayName + \"</option>\"\n            }\n            select.innerHTML = html\n        })\n    }\n\n    function loadPage(page) {\n        var promises = [ApiClient.getServerConfiguration(), populateLanguages(page.querySelector(\"#selectLanguage\")), populateCountries(page.querySelector(\"#selectCountry\"))];\n        Promise.all(promises).then(function(responses) {\n            var config = responses[0];\n            page.querySelector(\"#selectLanguage\").value = config.PreferredMetadataLanguage || \"\", page.querySelector(\"#selectCountry\").value = config.MetadataCountryCode || \"\", loading.hide()\n        })\n    }\n\n    function onSubmit() {\n        var form = this;\n        return loading.show(), ApiClient.getServerConfiguration().then(function(config) {\n            config.PreferredMetadataLanguage = form.querySelector(\"#selectLanguage\").value, config.MetadataCountryCode = form.querySelector(\"#selectCountry\").value, ApiClient.updateServerConfiguration(config).then(Dashboard.processServerConfigurationUpdateResult)\n        }), !1\n    }\n\n    function getTabs() {\n        return [{\n            href: \"library.html\",\n            name: Globalize.translate(\"HeaderLibraries\")\n        }, {\n            href: \"librarydisplay.html\",\n            name: Globalize.translate(\"TabDisplay\")\n        }, {\n            href: \"metadataimages.html\",\n            name: Globalize.translate(\"TabMetadata\")\n        }, {\n            href: \"metadatanfo.html\",\n            name: Globalize.translate(\"TabNfoSettings\")\n        }]\n    }\n\n    $(document).on(\"pageinit\", \"#metadataImagesConfigurationPage\", function() {\n        $(\".metadataImagesConfigurationForm\").off(\"submit\", onSubmit).on(\"submit\", onSubmit)\n    }).on(\"pageshow\", \"#metadataImagesConfigurationPage\", function() {\n        libraryMenu.setTabs(\"metadata\", 2, getTabs), loading.show(), loadPage(this)\n    })\n});\n"]}