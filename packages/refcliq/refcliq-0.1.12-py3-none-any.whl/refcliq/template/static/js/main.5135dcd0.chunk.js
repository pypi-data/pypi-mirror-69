(this.webpackJsonpvis=this.webpackJsonpvis||[]).push([[0],{138:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(68),s=a.n(i),l=(a(75),a(15)),o=a(14),c=a(19),u=a(18),d=(a(76),a(77),n.Component,a(16)),p=(a(78),a(0)),h=a.n(p),m=a(32),f=a(35);function g(e){var t=e.data,a=e.height,n=e.width,r=e.maxSteps,i=e.strength;if(!t)return{nodes:[],links:[]};var s=t.nodes.map((function(e){return Object(d.a)({},e)})),l=t.links.map((function(e){return Object(d.a)({},e)})),o=Object(m.d)(s).force("link",Object(m.b)().id((function(e){return e.id})).distance((function(e){return 1/e.weight}))).force("charge",Object(m.c)().strength(i)).force("center",Object(m.a)(n/2,a/2)).stop();o.force("link").links(l);for(var c=Math.ceil(Math.log(o.alphaMin())/Math.log(1-o.alphaDecay())),u=0;u<Math.min(r,c);++u)o.tick();return{nodes:s,links:l}}var v=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={data:g(e)},n}return Object(o.a)(a,null,[{key:"defaultProps",get:function(){return{className:"",data:{nodes:[],links:[]},maxSteps:50}}},{key:"propTypes",get:function(){return{className:h.a.string,data:h.a.object.isRequired,height:h.a.number.isRequired,width:h.a.number.isRequired,steps:h.a.number}}}]),Object(o.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState({data:g(e)})}},{key:"render",value:function(){var e=this.props,t=e.className,a=e.height,n=e.width,i=this.state.data,s=i.nodes,l=i.links;return r.a.createElement(f.c,{width:n,height:a,className:t},l.sort((function(e,t){return e.weight-t.weight})).map((function(e,t){var a=e.source,n=e.target;return r.a.createElement(f.a,{colorType:"literal",key:"link-".concat(t),opacity:.75,color:l[t].color,strokeWidth:Math.log(l[t].weight)+1,data:[Object(d.a)(Object(d.a)({},a),{},{color:null}),Object(d.a)(Object(d.a)({},n),{},{color:null})]})})),r.a.createElement(f.b,{data:s,colorType:"literal",stroke:"#ddd",strokeWidth:2}))}}]),a}(r.a.Component);v.displayName="ForceDirectedGraph";var y=v;function b(e,t,a,n){if(0===t.length)return[];for(var r={},i=[],s=0,l=0;l<t.length;l++)if(e[t[l]].hasOwnProperty(a)){s+=1;for(var o=0;o<e[t[l]][a].length;o++){var c=e[t[l]][a][o][0],u=e[t[l]][a][o][1];r.hasOwnProperty(c)?r[c]=r[c]+u:r[c]=u}}for(var d=Object.keys(r),p=0;p<d.length;p++)i.push([d[p],r[d[p]]/s]);return i=i.sort((function(e,t){return t[1]-e[1]})).slice(0,n)}var E=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={extended:{},min_cited:1,min_articles:1},n}return Object(o.a)(a,[{key:"componentWillReceiveProps",value:function(e){var t=e.articles;if(void 0!==t){var a=0;for(var n in t)a=Math.max(a,t[n].cites_this.length);a!==this.state.maxCites&&this.setState({maxCites:a})}}},{key:"render",value:function(){var e=this,t=this.props,a=t.articles,n=t.clusters,i=t.numberKeywords,s=[],l=void 0,o=function(e){return e.slice(0,i).map((function(e,t){return e[0]+", "}))};if(void 0!==a||void 0!==n){var c={};for(var u in l=0,n){var p=n[u].filter((function(t){return a[t].cites_this.length>=e.state.min_cited})).sort((function(e,t){return parseFloat(a[t].centrality)-parseFloat(a[e].centrality)}));c[u]=p,l=Math.max(l,p.length)}this.state.min_articles>l&&this.setState({min_articles:l});for(var h=Object.keys(n).sort((function(e,t){return c[t].length-c[e].length})),m=function(t){var n=h[t],l=c[n];if(l.length<e.state.min_articles)return"continue";var u=b(a,l,"keywords",i),p=[];u.length>0&&p.push(r.a.createElement("p",null,r.a.createElement("b",null,"Content keywords:")," ",o(u)));var m=[],f=b(a,l,"citing-keywords",i);f.length>0&&m.push(r.a.createElement("p",null,r.a.createElement("b",null,"Keywords of citing papers:")," ",o(f)));var g=[],v=[],E=function(t){var a=t.target.getAttribute("data-node");void 0!==e.props.selectCallback&&(e.props.selectCallback(a),e.setState({selected:a}))};if(e.state.extended.hasOwnProperty(n)&&e.state.extended[n]){if(l.length<=50&&void 0!==e.props.graphs&&e.props.graphs.hasOwnProperty(n)){var k={nodes:e.props.graphs[n].nodes.filter((function(e){return l.includes(e.id)})).map((function(t){return Object(d.a)(Object(d.a)({},t),{},{color:t.id===e.state.selected?"red":"darkblue"})})),links:e.props.graphs[n].links.filter((function(e){return l.includes(e.source)&&l.includes(e.target)})).map((function(t){return Object(d.a)(Object(d.a)({},t),{},{color:t.source===e.state.selected||t.target===e.state.selected?"red":"gray"})}))};v.push(r.a.createElement("div",{style:{width:"fit-content",margin:"auto"}},r.a.createElement(y,{data:k,height:300,width:300,strenght:100})))}for(var x=0;x<l.length;x++){var j=a[l[x]],w="";j.authors.length>0&&(w=w+j.authors[0].last+", "+j.authors[0].first),void 0!==j.year&&(w=w+" ("+j.year+") "),void 0!==j.title&&(w=w+" "+j.title+"."),void 0!==j.journal&&(w=w+" "+j.journal+"."),g.push(r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("p",{"data-node":l[x],onClick:E},r.a.createElement("a",{href:"#","data-node":l[x],onClick:E},w))),r.a.createElement("td",{align:"center"},Math.round(100*j.centrality)/100),r.a.createElement("td",{align:"center"},j.cites_this.length),r.a.createElement("td",null,void 0!==j.keywords?o(j.keywords):null),r.a.createElement("td",null,void 0!==j["citing-keywords"]?o(j["citing-keywords"]):null)))}}s.push(r.a.createElement("div",{className:"eachCluster"},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{style:{display:"block"}},p,m),r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"0"}},r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"0",display:"flex"}},r.a.createElement("img",{src:e.state.extended[n]?"chevron-top.svg":"chevron-bottom.svg",title:e.state.extended[n]?"Collapse":"Expand",alt:e.state.extended[n]?"Collapse":"Expand",height:"18",width:"18","data-cluster":n,onClick:function(t){var a=t.target.getAttribute("data-cluster"),r=Object(d.a)({},e.state.extended);r.hasOwnProperty(a)?r[n]=!r[n]:r[n]=!0,e.setState({extended:r})},style:{paddingLeft:"2px",paddingTop:"2px",verticalAlign:"middle",cursor:"pointer",marginRight:"10px",marginLeft:"auto"}})),r.a.createElement("p",null,"Number of articles: ",l.length))),g.length>0?r.a.createElement("div",null,v,r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("b",null,"Name")),r.a.createElement("td",null,r.a.createElement("b",null,"Centrality")),r.a.createElement("td",null,r.a.createElement("b",null,"#Cited")),r.a.createElement("td",null,r.a.createElement("b",null,"Keywords")),r.a.createElement("td",null,r.a.createElement("b",null,"Keywords of citing works"))),g))):null))},f=0;f<h.length;f++)m(f)}return r.a.createElement("div",{className:"clusters"},void 0!==this.state.maxCites?r.a.createElement("div",{style:{margin:"auto",padding:"5px",display:"flex",width:"fit-content"}},r.a.createElement("p",{style:{marginRight:"20px"}},"Minimum number of citations: ",this.state.min_cited," "),r.a.createElement("p",{style:{marginRight:"20px"}},"1"),r.a.createElement("input",{type:"range",className:"slider",min:1,max:this.state.maxCites,defaultValue:this.state.min_cited,onChange:function(t){e.setState({min_cited:parseInt(t.target.value)})}}),r.a.createElement("p",null,this.state.maxCites)):null,void 0!==l?r.a.createElement("div",{style:{margin:"auto",padding:"5px",display:"flex",width:"fit-content"}},r.a.createElement("p",{style:{marginRight:"20px"}},"Minimum number of articles in the cluster: ",this.state.min_articles," "),r.a.createElement("p",{style:{marginRight:"20px"}},"1"),r.a.createElement("input",{type:"range",className:"slider",min:1,max:l,defaultValue:this.state.min_articles,onChange:function(t){e.setState({min_articles:parseInt(t.target.value)})}}),r.a.createElement("p",null,l)):null,s)}}]),a}(n.Component),k=(a(90),a(53)),x=a.n(k),j=(a(91),a(92),a(69)),w=a.n(j);x.a.accessToken="pk.eyJ1IjoiZGlhc2YiLCJhIjoiY2pqc243cW9wNDN6NTNxcm1jYW1jajY2NyJ9.2C0deXZ03NJyH2f51ui4Jg";var O=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={map:void 0},n}return Object(o.a)(a,[{key:"addLayer",value:function(e,t){if(0!==e.features.length){var a=w()(e);a=[[a[0],a[1]],[a[2],a[3]]],this.map.getLayer("points")&&this.map.removeLayer("points"),this.map.getSource("points")&&this.map.removeSource("points"),this.map.addSource("points",{type:"geojson",data:e}),!1===t?this.map.addLayer({id:"points",type:"symbol",source:"points",layout:{"icon-image":"{icon}-15","icon-allow-overlap":!0,"text-field":"{title}","text-allow-overlap":!0,"text-offset":[0,.6],"text-anchor":"top"}}):this.map.addLayer({id:"points",type:"heatmap",source:"points",paint:{"heatmap-opacity":.5,"heatmap-weight":["log10",["get","count"]]}}),!0===this.props.fit&&this.map.fitBounds(a,{padding:{top:20,bottom:20,left:30,right:30}}),this.setState({map:this.map})}}},{key:"setFill",value:function(){}},{key:"componentDidUpdate",value:function(){this.setFill()}},{key:"componentWillReceiveProps",value:function(e){void 0===e.geojson||this.props.heatmap===e.heatmap&&this.props.year===e.year&&this.props.cumulative===e.cumulative&&this.props.selected===e.selected||this.addLayer(e.geojson,e.heatmap)}},{key:"componentDidMount",value:function(){var e=this;this.map=new x.a.Map({container:this.mapContainer,style:"mapbox://styles/mapbox/light-v9",zoom:.6,maxzoom:12}),this.map.on("load",(function(){void 0!==e.props.geojson&&e.addLayer(e.props.geojson)}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{ref:function(t){return e.mapContainer=t},className:void 0!==this.props.className?this.props.className:"absolute top right left bottom"})}}]),a}(r.a.Component),C=a(28);a(63);function S(e){for(var t="",a=0;a<e.length;a++)t=t+e[a].last+", "+e[a].first,a!==e.length-1?t+="; ":t+=". ";return t}function N(e){for(var t="",a=Object.keys(e),n=0;n<a.length;n++)t=t+"("+a[n]+","+e[a[n]]+")",n!==a.length-1&&(t+=";");return t}function _(e){for(var t="",a=0;a<e.length;a++)t=t+"("+e[a][0]+","+e[a][1]+")",a!==e.length-1&&(t+=";");return t}function L(e,t){return void 0!==e[t]?("string"===typeof e[t]||e[t]instanceof String)&&e[t].length>0&&"."!==e[t][e[t].length-1]?e[t]+". ":e[t]:null}var R=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={geojson:void 0,citingList:[],cumulative:!1,fit:!0,heatmap:!1,year:"-1"},n}return Object(o.a)(a,[{key:"updateGeoJSON",value:function(e,t,a,n){for(var r={type:"FeatureCollection",features:[]},i=0;i<e[t].cites_this.length;i++){var s=e[e[t].cites_this[i]];if(void 0!==s.coordinates&&0!==s.coordinates.length)for(var l=0;l<s.coordinates.length;l++)"-1"!==a&&(!n&&a!==s.year||n&&parseInt(s.year,10)>parseInt(a,10))||r.features.push({type:"Feature",properties:{year:s.year,count:s.coordinates.length,title:s.year,icon:"marker"},geometry:{type:"Point",coordinates:s.coordinates[l]}})}return r}},{key:"componentWillReceiveProps",value:function(e){if(void 0!==e.selected&&e.selected!==this.props.selected){for(var t=e.articles[e.selected].cites_this.slice().sort((function(t,a){return parseInt(e.articles[t].year,10)-parseInt(e.articles[a].year,10)})),a=this.updateGeoJSON(e.articles,e.selected,this.state.year,this.state.cumulative),n=[],r=[],i=0;i<t.length;i++)n.push(e.articles[t[i]].year);n=Array.from(new Set(n)).sort((function(e,t){return parseInt(e,10)-parseInt(t,10)})),r.push({id:"-1",name:"All"});for(var s=0;s<n.length;s++)r.push({id:n[s],name:n[s]});this.setState({geojson:a,citingList:t,yearOptions:r})}}},{key:"render",value:function(){var e,t=this,a=this.props,n=a.articles,i=a.selected,s=a.cites_year,l=[],o=[];if(void 0!==i&&o.push(r.a.createElement("div",{style:{margin:"20px",display:"flex"}},r.a.createElement("h2",null,"Works that cite: ",S(n[i].authors),L(n[i],"year"),L(n[i],"title"),L(n[i],"journal")),r.a.createElement("div",{className:"hfill"},r.a.createElement("button",{onClick:function(){var e=document.createElement("a"),a=new Blob(function(){for(var e=[],a=[],r=0;r<t.state.citingList.length;r++)for(var i=Object.keys(n[t.state.citingList[r]]),s=0;s<i.length;s++)a.push(i[s]);a=Array.from(new Set(a)),e.push("id\t"+a.join("\t")+"\n");for(var l=0;l<t.state.citingList.length;l++){for(var o=n[t.state.citingList[l]],c=String(t.state.citingList[l]+"\t"),u=0;u<a.length;u++){var d=a[u];if(void 0!==o[d])switch(d){case"authors":c+=S(o.authors);break;case"coordinates":c+=_(o.coordinates);break;case"cites_year":c+=N(o.cites_year);break;default:c+=L(o,d)}u!==a.length-1&&(c+="\t")}e.push(c+"\n")}return e}(),{type:"text/plain"});e.href=URL.createObjectURL(a),e.download=(S(n[i].authors)+L(n[i],"year")+".tsv").replace(/\s+/g,"").replace(/\.\./g,"."),document.body.appendChild(e),e.click()}},"Export tsv file")))),void 0!==this.state.citingList)for(var c=0;c<this.state.citingList.length;c++){var u=n[this.state.citingList[c]],d=S(u.authors);l.push(r.a.createElement("li",null,r.a.createElement("div",{style:{display:"flex",width:"100%",marginTop:0}},d,L(u,"year"),L(u,"title"),L(u,"journal"),L(u,"vol"),L(u,"page"),r.a.createElement("div",{className:"hfill",style:{marginTop:0}},void 0!==u.doi?r.a.createElement("p",{style:{marginTop:0}},r.a.createElement("a",{href:"http://dx.doi.org/"+u.doi,target:"_blank",rel:"noopener noreferrer"},"DOI")):null)),r.a.createElement("div",{className:"abstract"},r.a.createElement("p",null,L(u,"abstract"))),r.a.createElement("p",{style:{fontSize:"small"}},L(u,"Affiliation"))))}var p,h=0;void 0!==s&&(e=Object.keys(s).map((function(e){return h=Math.max(h,s[e]),{x:parseInt(e,10),y:s[e]}})));var m=0;return void 0!==i&&(p=Object.keys(n[i].cites_year).map((function(e){return m=Math.max(m,n[i].cites_year[e]),{x:parseInt(e,10),y:n[i].cites_year[e]}}))),r.a.createElement("div",{className:"citing"},r.a.createElement("div",{className:"map"},r.a.createElement(O,{geojson:this.state.geojson,selected:i,heatmap:this.state.heatmap,year:this.state.year,fit:this.state.fit,cumulative:this.state.cumulative})),r.a.createElement("div",{style:{display:"flex",height:"fit-content",width:"fit-content"}},void 0!==this.state.yearOptions?r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("input",{name:"fitmap",type:"checkbox",defaultChecked:this.state.fit,key:"fit",onChange:function(e){t.setState({fit:e.target.checked})}})," Fit to markers",r.a.createElement("input",{name:"heatmap",type:"checkbox",defaultChecked:this.state.heatmap,key:"heat",onChange:function(e){t.setState({heatmap:e.target.checked})}})," Heatmap",r.a.createElement("select",{defaultValue:this.state.year,style:{marginLeft:"20px"},onChange:function(e){var a=e.target.value,n=t.updateGeoJSON(t.props.articles,t.props.selected,a,t.state.cumulative);t.setState({geojson:n,year:a})}},this.state.yearOptions.map((function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.name)}))),r.a.createElement("input",{name:"cumulative",type:"checkbox",defaultChecked:this.state.cumulative,key:"cumulative",onChange:function(e){var a=t.updateGeoJSON(t.props.articles,t.props.selected,t.state.year,e.target.checked);t.setState({geojson:a,cumulative:e.target.checked})}})," Cumulative"):null),r.a.createElement("div",{style:{border:"solid",borderWidth:"thin",borderColor:"lightgray"}},r.a.createElement(C.XYPlot,{width:790,height:400,margin:{left:50,right:60,top:20,bottom:60}},void 0!==i?r.a.createElement(C.VerticalBarSeries,{color:"green",data:p.map((function(e){return{x:e.x,y:h*(e.y/m)}}))}):null,void 0!==s?r.a.createElement(C.VerticalBarSeries,{data:e,color:"blue"}):null,r.a.createElement(C.XAxis,{tickLabelAngle:-30,style:{text:{fontSize:"10px"}}}),r.a.createElement(C.YAxis,{style:{line:{stroke:"blue"},text:{fontSize:"10px"}}}),void 0!==i?r.a.createElement(C.YAxis,{orientation:"right",tickFormat:function(e){return"".concat(Math.round(m*(e/h)))},style:{line:{stroke:"green"},text:{fontSize:"10px"}}}):null),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{style:{display:"flex",float:"left",margin:"5px"}},r.a.createElement("div",{style:{margin:"auto 10px",width:"10px",height:"10px",backgroundColor:"blue"}}),r.a.createElement("p",{style:{margin:"auto 0px"}},"Number of citations (total)    ")),r.a.createElement("div",{style:{display:"flex",float:"left",margin:"5px"}},r.a.createElement("div",{style:{margin:"auto 10px",width:"10px",height:"10px",backgroundColor:"green"}}),r.a.createElement("p",{style:{margin:"auto 0px"}},"Number of citations (selection)")),r.a.createElement("div",{style:{float:"right",margin:"5px"}},r.a.createElement("button",{onClick:function(){var e=document.createElement("a"),t=new Blob(function(){for(var e=["year\tglobal\tselection\n"],t=Object.keys(s).sort(),a=0;a<t.length;a++){var r=t[a].toString()+"\t";s.hasOwnProperty(t[a])&&(r+=s[t[a]].toString()),r+="\t",void 0!==i&&n[i].cites_year.hasOwnProperty(t[a])&&(r+=n[i].cites_year[t[a]]),r+="\n",e.push(r)}return e}(),{type:"text/plain"});e.href=URL.createObjectURL(t),e.download=void 0!==i?(S(n[i].authors)+L(n[i],"year")+".counts.tsv").replace(/\s+/g,"").replace(/\.\./g,"."):"total.counts.tsv",document.body.appendChild(e),e.click()}},"Export table")))),r.a.createElement("div",{className:"citationlist"},o,r.a.createElement("div",null,r.a.createElement("ul",null,l))))}}]),a}(n.Component);var M=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={nKeywords:5},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e,t=this;e=function(e){console.log(e),t.setState({articles:e.articles,clusters:e.partitions,graphs:e.graphs,cites_year:e.cites_year})},fetch("data.json").then((function(e){if(e.status>=400)throw new Error("Bad response from server");return e.json()})).then(e)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"bottom"},r.a.createElement(E,{articles:this.state.articles,clusters:this.state.clusters,numberKeywords:this.state.nKeywords,graphs:this.state.graphs,selectCallback:function(t){e.setState({selected:t})}}),r.a.createElement(R,{articles:this.state.articles,selected:this.state.selected,cites_year:this.state.cites_year})))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},70:function(e,t,a){e.exports=a(138)},75:function(e,t,a){},76:function(e,t,a){},77:function(e,t,a){},78:function(e,t,a){},90:function(e,t,a){},92:function(e,t,a){}},[[70,1,2]]]);
//# sourceMappingURL=main.5135dcd0.chunk.js.map